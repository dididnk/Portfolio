<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="Multimédia SOLUTIONS (c) https://www.lug.com">
<title>Documentation de BotServer</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Documentation de BotServer</h1>
<div class="details">
<span id="author" class="author">Multimédia SOLUTIONS (c) https://www.lug.com</span><br>
<span id="revnumber">version v3.0,</span>
<span id="revdate">February 11, 2016</span>
<br><span id="revremark">Initial Release</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table des matières</div>
<ul class="sectlevel1">
<li><a href="#_botserver"><span class="navy">BotServer</span></a></li>
<li><a href="#_interface"><span class="navy">Interface</span></a>
<ul class="sectlevel2">
<li><a href="#subtitle-21"><span class="navy">Connexion</span></a></li>
<li><a href="#subtitle-22"><span class="navy">Page d’accueil</span></a></li>
<li><a href="#_création_et_gestion_des_robots"><span class="navy">Création et gestion des robots</span></a>
<ul class="sectlevel3">
<li><a href="#_création_dun_robot_de_tâches"><span class="navy">Création d’un robot de tâches</span></a></li>
<li><a href="#_les_différents_éléments_dun_robot"><span class="navy">Les différents éléments d’un robot</span></a></li>
<li><a href="#_création_et_gestion_des_tâches"><span class="navy">Création et gestion des tâches</span></a>
<ul class="sectlevel4">
<li><a href="#_création_dun_robot"><span class="navy">Création d&#8217;un robot</span></a></li>
<li><a href="#_les_différents_éléments_de_lédition_des_tâches"><span class="navy">Les différents éléments de l&#8217;édition des tâches</span></a></li>
</ul>
</li>
<li><a href="#_les_tâches"><span class="navy">Les tâches</span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#title-3"><span class="navy">Langage de macro</span></a>
<ul class="sectlevel2">
<li><a href="#_bases_du_macro_langage"><span class="navy">Bases du macro langage</span></a></li>
<li><a href="#_syntaxe_des_fonctions"><span class="navy">Syntaxe des fonctions</span></a></li>
<li><a href="#_syntaxe_des_variables"><span class="navy">Syntaxe des variables</span></a></li>
<li><a href="#_macro_spéciale"><span class="navy">Macro spéciale</span></a>
<ul class="sectlevel3">
<li><a href="#_affectation_de_variable"><span class="navy">Affectation de variable</span></a></li>
<li><a href="#_opérations_conditionnelles"><span class="navy">Opérations conditionnelles</span></a></li>
<li><a href="#_opérateurs_logiques"><span class="navy">Opérateurs logiques</span></a></li>
<li><a href="#_boucle_dans_une_macro"><span class="navy">Boucle dans une macro</span></a></li>
<li><a href="#_instruction_ditération_de_texte"><span class="navy">Instruction d’itération de texte</span></a></li>
</ul>
</li>
<li><a href="#_les_fonctions"><span class="navy">Les fonctions</span></a>
<ul class="sectlevel3">
<li><a href="#_fonctions_de_base_environnement"><span class="navy">Fonctions de base (environnement @)</span></a>
<ul class="sectlevel4">
<li><a href="#_fonctions_sur_les_chaînes"><span class="navy">Fonctions sur les chaînes</span></a></li>
<li><a href="#_fonctions_de_comparaison"><span class="navy">Fonctions de comparaison</span></a></li>
<li><a href="#_fonctions_de_trace"><span class="navy">Fonctions de trace</span></a></li>
<li><a href="#_fonctions_de_conversion"><span class="navy">Fonctions de conversion</span></a></li>
<li><a href="#_fonctions_mathématiques"><span class="navy">Fonctions mathématiques</span></a></li>
<li><a href="#_manipulations_de_dates"><span class="navy">Manipulations de dates</span></a></li>
<li><a href="#_fonctions_web"><span class="navy">Fonctions Web</span></a></li>
<li><a href="#_fonctions_diverses"><span class="navy">Fonctions diverses</span></a></li>
</ul>
</li>
<li><a href="#_fonctions_de_fichiers_environnement_file"><span class="navy">Fonctions de fichiers (environnement @File)</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_botserver"><span class="navy">BotServer</span></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Le logiciel BotServer permet de créer des robots de tâches. Il permet de configurer un certain nombre de tâches exécutées par l’ordinateur et qui seront lancées en fonction de règles pré-définies dans le robot.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interface"><span class="navy">Interface</span></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="subtitle-21"><span class="navy">Connexion</span></h3>
<div class="paragraph">
<p>L’accès au logiciel BotServer nécessite de se connecter sur l’adresse
<a href="http://localhost:9000/">suivante</a>.
Localhost est le nom du serveur, sauf si vous êtes sur le serveur sur lequel est installé BotServer.
Le login par défaut est : "administrator" avec pour mot de passe "administrator" :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/login.png" alt="login" width="800em">
</div>
<div class="title">Capture d'écran 1.Connexion à BotServer</div>
</div>
</div>
<div class="sect2">
<h3 id="subtitle-22"><span class="navy">Page d’accueil</span></h3>
<div class="paragraph">
<p>Une fois quelques robots ajoutés, vous obtiendrez la page d’accueil ci-dessous :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotlist.png" alt="robotlist" width="800em">
</div>
<div class="title">Capture d'écran 2. Liste des robots</div>
</div>
<div class="paragraph">
<p>Les dénominations des boutons sont basées sur leurs infobulles (passer la souris dessus) :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bouton "A propos" : Il sert à informer sur la société Multimédia Solutions et les droits d&#8217;utilisation de Botserver.</p>
</li>
<li>
<p>Bouton "Documentation" : Il sert à accéder à la documentation que vous consultez actuellement.</p>
</li>
<li>
<p>Bouton "Se déconnecter" : Il sert à se déconnecter de votre compte utilisateur et revenir sur la page de connexion (voir <a href="#subtitle-21">ici</a> pour se connecter).</p>
</li>
<li>
<p>Lien "Lien vers le site de Multimédia Solutions".</p>
</li>
<li>
<p>Bouton "Nommer un nouveau robot" : Il sert à créer  un nouveau robot en donnant un nom.</p>
</li>
<li>
<p>Bouton activer/désactiver un robot : Pour que le robot puisse exécuter ses tâches sur les fichiers concernés, le voyant doit être allumé. Si ce n&#8217;est pas le cas, il suffit de cliquer dessus. La solution est la même lorsque vous souhaitez le désactiver.</p>
</li>
<li>
<p>Edition d&#8217;un robot : Vous pouvez accéder à ses tâches en cliquant sur le robot ou bien accéder aux paramètres du robot en  cliquant sur l&#8217;engrenage.</p>
</li>
<li>
<p>Bouton "Supprimer le robot sélectionné" : Après confirmation, il sert à supprimer un robot avec toutes ses données.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Nouveauté</div>
<div class="paragraph">
<p>Vous pouvez maintenant gérer la présentation de vos robots (champ de recherche, tri, pagination).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="title">Attention!</div>
<div class="ulist">
<ul>
<li>
<p>Il faut d&#8217;abord désactiver le robot avant de pouvoir le supprimer.</p>
</li>
<li>
<p>Le nom du robot doit contenir uniquement des lettres, chiffres et les caractères \"-_.\"</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/deletetry.png" alt="deletetry" width="800em">
</div>
<div class="title">Capture d'écran 3. Tentative de suppression d&#8217;un robot activé</div>
</div>
</div>
<div class="sect2">
<h3 id="_création_et_gestion_des_robots"><span class="navy">Création et gestion des robots</span></h3>
<div class="sect3">
<h4 id="_création_dun_robot_de_tâches"><span class="navy">Création d’un robot de tâches</span></h4>
<div class="paragraph">
<p>Sur la page d’accueil cliquez sur le bouton "Nouveau Robot".</p>
</div>
<div class="paragraph">
<p>Saisir le nom de votre robot <em>(exemple : "Envoi vers GED")</em> puis cliquer sur "Créer".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/addrobot.png" alt="addrobot" width="800em">
</div>
<div class="title">Capture d'écran 4. Création et nommage d&#8217;un nouveau robot</div>
</div>
</div>
<div class="sect3">
<h4 id="_les_différents_éléments_dun_robot"><span class="navy">Les différents éléments d’un robot</span></h4>
<div class="imageblock">
<div class="content">
<img src="./screens/robotparams.png" alt="robotparams" width="800em">
</div>
<div class="title">Capture d'écran 5. Edition des paramètres d&#8217;un robot</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Nom: Nom du robot.</p>
</li>
<li>
<p>Type de robot :</p>
<div class="ulist">
<ul>
<li>
<p>"Surveillance d&#8217;un fichier" : Le robot attend qu’un fichier existe pour lancer les tâches assignées au préalable.</p>
</li>
<li>
<p>"Surveillance d&#8217;un dossier" : Le robot attend qu&#8217;un dossier contienne des fichiers pour lancer les tâches assignées au préalable. Choix de défaut.</p>
</li>
<li>
<p>"Surveillance d&#8217;un dossier et ses sous-dossiers" : Le robot attend qu&#8217;un dossier contienne des fichiers dans ses sous-dossiers ou lui-même pour lancer les tâches assignées au préalable.</p>
</li>
<li>
<p>"Surveillance d&#8217;un dossier FTP" : Le robot attend qu&#8217;un dossier distant (pas sur le même PC que l&#8217;utilisateur) contienne des fichiers pour lancer les tâches assignées au préalable.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Période (ms) : La fréquence à laquelle le robot vérifie la présence de fichiers dans le ou les dossiers toutes les x millisecondes. Une période de 1000 à 5000ms (5s) est conseillé.</p>
</li>
<li>
<p>Délai (ms) : Pour éviter de solliciter le serveur dès son lancement ou un empilement de robots lancés simultanément, ce champ donne un délai d&#8217;activation au robot lors du lancement de BotServer.</p>
</li>
<li>
<p>Retard (ms) : Pour éviter un conflit entre un utilisateur et un robot cherchant à modifier un même fichier, on impose un retard de date de mise à jour du fichier du  côté du robot.</p>
</li>
<li>
<p>Dossier de dépôt : Dossier de référence où les fichiers sont supposés être déposés avant d&#8217;être traités par les tâches assignées.</p>
</li>
<li>
<p>Condition : En plus de la présence de fichiers selon le dossier de dépôt et le type de robot, une condition peut être ajoutée au robot pour lancer ses tâches. En cliquant sur "Saisir une condition", une condition est ensuite complétée <em>(Par exemple : attendre qu’un dossier de destination soit vide avant de lui envoyer des fichiers)</em> et si la condition est vraie, alors les tâches sont lancées.</p>
</li>
<li>
<p>Description : La description du robot. Il n&#8217;y a pas de limites de caractères.</p>
</li>
<li>
<p>Nom du groupe de robots : Groupe servant d&#8217;étiquette au robot pour catégoriser plusieurs robots liés à une activité similaire.</p>
</li>
<li>
<p>Log : Nom du fichier log événementiel lorsque le robot est démarré.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotparamsspyfile.png" alt="robotparamsspyfile" width="800em">
</div>
<div class="title">Capture d'écran 6. Edition des paramètres d&#8217;un robot en surveillant un dossier</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Valable pour la surveillance d&#8217;un dossier, d&#8217;un dossier et ses sous-dossiers et d&#8217;un dossier FTP :</p>
<div class="ulist">
<ul>
<li>
<p>Nombre max de fichiers à traiter : Nombre maximum de fichiers consécutifs à traiter. Lorsque ce nombre est atteint, le robot attend la prochaine scrutation.<br>
Cela permet d’effectuer des attentes liées à la période.<br>
Ce paramètre est utile car certains logiciels plantent lorsqu’on leur envoie trop de fichiers d’affilé.</p>
</li>
<li>
<p>Filtre : Seul les fichiers correspondant au filtre choisi seront traités par les tâches du robot. Le mode "EXPERT" permet d&#8217;avoir un filtre personnalisé.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Nouveauté</div>
<div class="paragraph">
<p>Le filtre dispose de modes prédéfinis désormais.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotparamsspyfileftp.png" alt="robotparamsspyfileftp" width="800em">
</div>
<div class="title">Capture d'écran 7. Edition des paramètres d&#8217;un robot en surveillant un dossier FTP</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Valable pour la surveillance d&#8217;un dossier FTP :</p>
<div class="ulist">
<ul>
<li>
<p>Serveur : Nom de domaine du serveur à accéder.</p>
</li>
<li>
<p>N° port : Numéro de port à préciser pour échanger avec le serveur. Si le champ est vide, il s&#8217;agit du port 21.</p>
</li>
<li>
<p>Nom d&#8217;utilisateur : Nom d&#8217;utilisateur pour se connecter sur le serveur.</p>
</li>
<li>
<p>Mot de passe : Mot de passe pour se connecter sur le serveur.</p>
</li>
<li>
<p>Dossier distant : Dossier se trouvant dans le serveur avec pour racine du chemin absolu la racine du serveur.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Information</div>
<div class="ulist">
<ul>
<li>
<p>Plusieurs robots peuvent utiliser le même fichier de log.</p>
</li>
<li>
<p>En mode EXPERT, le filtre doit être noté sous la forme d&#8217;une expression régulière de type Java :
Plus d&#8217;informations <a href="http://urlhttp://blog.paumard.org/cours/java-api/chap03-expression-regulieres-syntaxe.html">ici</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotparamsspyfileexpert.png" alt="robotparamsspyfileexpert" width="800em">
</div>
<div class="title">Capture d'écran 8. Edition des paramètres d&#8217;un robot en surveillant un dossier avec le mode Expert</div>
</div>
</div>
<div class="sect3">
<h4 id="_création_et_gestion_des_tâches"><span class="navy">Création et gestion des tâches</span></h4>
<div class="sect4">
<h5 id="_création_dun_robot"><span class="navy">Création d&#8217;un robot</span></h5>
<div class="paragraph">
<p>Cliquer sur le bouton "+" ("Créer une tâche" en infobulle) puis choisir le type de tâche affiché dans la boîte de dialogue "Choisissez une tâche".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotaddtask1.png" alt="robotaddtask1" width="800em">
</div>
<div class="title">Capture d'écran 9. Ajout d&#8217;une tâche : étape 1</div>
</div>
<div class="paragraph">
<p>Cliquer sur une tâche <em>(ici nous avons pris la tâche suivante "Envoyer un document vers windex GED").</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotaddtask2.png" alt="robotaddtask2" width="800em">
</div>
<div class="title">Capture d'écran 10. Ajout d&#8217;une tâche : étape 2</div>
</div>
<div class="paragraph">
<p>Pour chaque tâche, il y a une liste de paramètres à renseigner. Dans chaque champ de paramétrage, vous pouvez utiliser un langage de macro (voir chapitre <a href="#title-3">Langage de Macro</a>) en mettant les instructions entre deux "$".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./screens/robotaddtask3.png" alt="robotaddtask3" width="800em">
</div>
<div class="title">Capture d'écran 11. Ajout d&#8217;une tâche : étape 3</div>
</div>
</div>
<div class="sect4">
<h5 id="_les_différents_éléments_de_lédition_des_tâches"><span class="navy">Les différents éléments de l&#8217;édition des tâches</span></h5>
<div class="imageblock">
<div class="content">
<img src="./screens/robottasks.png" alt="robottasks" width="800em">
</div>
<div class="title">Capture d'écran 12. Edition des tâches d&#8217;un robot</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Bouton "Maison" (Liste des robots en infobulle) : Permet de revenir à la page d&#8217;accueil où tous les robots sont répertoriés <em>(pour en savoir plus, cliquer <a href="#subtitle-22">ici</a>)</em>.</p>
</li>
<li>
<p>Bouton "Sauvegarder" : Permet de sauvegarder toutes les modifications liées au robot.</p>
</li>
<li>
<p>Les Tâches/Paramètres du robot : Selon où vous vous situez <strong>dans l&#8217;édition d&#8217;un robot</strong>, vous pourrez toujours accéder à vos données et vos modifications de données. Pensez à sauvegarder avant de revenir sur la <a href="#subtitle-22">liste de robots</a>.</p>
</li>
<li>
<p>Bouton de suppression ( <span class="icon">[trash]</span> ) : Permet de supprimer une tâche. <strong>L&#8217;action ne possède pas, contrairement à la suppression d&#8217;un robot, une demande de confirmation !</strong></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Information</div>
<div class="ulist">
<ul>
<li>
<p>Chaque robot peut accéder au chemin complet du fichier en cours au travers de la macro $File$.</p>
</li>
<li>
<p>Les tâches sont exécutées dans l’ordre d’apparition. Elle peuvent être déplacées par glisser/déplacer en cliquant sur le titre de la tâche.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Nouveauté</div>
<div class="ulist">
<ul>
<li>
<p>Pour une meilleure lisibilité, il est désormais possible de cacher et déployer une ou plusieurs tâches avec le bouton <span class="icon">[chevron down]</span> (à côté de <span class="icon">[trash]</span>) . Elles se cacheront à nouveau par défaut si vous quittez l&#8217;édition du robot.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_les_tâches"><span class="navy">Les tâches</span></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Macro</dt>
<dd>
<p>Cette tâche lance une macro (voir <a href="#title-3">Langage de Macro</a>).</p>
</dd>
<dt class="hdlist1">Exécuter une application</dt>
<dd>
<p>Lance automatiquement une application tierce <em>(logiciel métier par exemple)</em>.</p>
</dd>
<dt class="hdlist1">Exécuter une méthode Java</dt>
<dd>
<p>Permet un développement spécifique sur une méthode sous Java.</p>
</dd>
<dt class="hdlist1">Copier un fichier</dt>
<dd>
<p>Copie le fichier à traiter vers un dossier de destination.</p>
</dd>
<dt class="hdlist1">Déplacer un fichier vers un dossier</dt>
<dd>
<p>Déplace un fichier à traiter vers un dossier de destination.</p>
</dd>
<dt class="hdlist1">Déplacer et/ou renommer un fichier</dt>
<dd>
<p>Déplace ou renomme un fichier à traiter vers un dossier de destination.</p>
</dd>
<dt class="hdlist1">Renommer un fichier</dt>
<dd>
<p>Renomme un fichier à traiter.</p>
</dd>
<dt class="hdlist1">Créer un dossier et sous dossier</dt>
<dd>
<p>Créer tous les dossiers correspondant au chemin indiqué.</p>
</dd>
<dt class="hdlist1">Supprimer un fichier</dt>
<dd>
<p>Supprime un fichier à traiter.</p>
</dd>
<dt class="hdlist1">Concaténer deux fichiers en un seul</dt>
<dd>
<p>Contrairement à la fusion des fichiers PDF (voir <a href="BotServer-doc/#">ici</a></p>
</dd>
<dt class="hdlist1">Convertir un fichier texte en CSV</dt>
<dt class="hdlist1">Convertir un fichier texte en xlsx</dt>
<dt class="hdlist1">Découper le fichier PDF en plusieurs PDF de n pages</dt>
<dt class="hdlist1">Découper en 2 les pages du fichier PDF</dt>
<dd>
<p>Le fichier PDF doit être constitué uniquement d’images. Un nouveau fichier PDF sera généré et comprendra le double de page, ou chaque page est la moité d’une page du document initial.</p>
</dd>
<dt class="hdlist1">Fusionner des fichiers PDF</dt>
<dd>
<p>Cette tâche permet de concaténer ou assembler plusieurs fichiers PDF dans un seul document PDF.</p>
</dd>
<dt class="hdlist1">Agencement des pages d’un PDF</dt>
<dd>
<p>Permet de ré-ordonner les pages dans le document PDF.</p>
</dd>
<dt class="hdlist1">Découper le PDF suivant pages ses séparations (code barre)</dt>
<dd>
<p>Découpe en plusieurs PDF un document comportant des pages de séparation ayant un code barre (E39) répondant à un critère de la règle regexp.</p>
</dd>
<dt class="hdlist1">Prévisualisation du PDF</dt>
<dd>
<p>Cette tâche permet de créer un fichier image correspondant à une vignette de prévisualisation du fichier PDF.</p>
</dd>
<dt class="hdlist1">Supprimer les pages blanches d’un PDF</dt>
<dd>
<p>Suppression de pages blanches générées par la numérisation recto/verso, par exemple.</p>
</dd>
<dt class="hdlist1">Inverser l’ordre des pages du PDF</dt>
<dd>
<p>Dans le fichier de sortie, la première page devient la dernière, et inversement &#8230;&#8203;​</p>
</dd>
<dt class="hdlist1">Repaginer le PDF</dt>
<dd>
<p>Permet de refaire la pagination d’un fichier PDF.</p>
</dd>
<dt class="hdlist1">Découper le document PDF</dt>
<dd>
<p>Découpe automatique des fichiers en fonction de règles pré-définies.</p>
</dd>
<dt class="hdlist1">OCR image vers PDF/A</dt>
<dd>
<p>Reconnaissaance automatique de caractères. Cette tâche convertit une image (jpg, png, gif) ou les images d’un fichier image tiff en un fichier PDF/A. Le texte reconnu par l’OCR est incrusté en arriere plan.</p>
</dd>
<dt class="hdlist1">Extrait des zones de texte du PDF</dt>
<dt class="hdlist1">Découpage d’images par code barre</dt>
<dd>
<p>Exemple d’utilisation : le code barre peut servir de séparateur lors de la numérisation d’un lot de documents.</p>
</dd>
<dt class="hdlist1">Découper un document imge/PDF ayant des page de séparation comportant un séparateur de type code barre</dt>
<dd>
<p>Découpe en plusieurs fichier un document comportant des pages de séparation ayant un code barre (E39) répondant à un critère.</p>
</dd>
<dt class="hdlist1">Envoyer un document sur Windex GED</dt>
<dd>
<p>Envoie le fichier dans Windex GED.</p>
</dd>
<dt class="hdlist1">Langage de macro</dt>
<dd>
<p>Dans les champs de saisie des taches vous pouvez appeler les fonctions du langage de macro en entourant votre macro par deux "$". Ainsi $File$ sera remplacé par le chemin complet du fichier.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="title-3"><span class="navy">Langage de macro</span></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dans les champs de saisie des tâches, vous pouvez appeler les fonctions du langage de macro en entourant votre macro par deux "$". Ainsi $File$ sera remplacé par le chemin complet du fichier</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Le macro langage est sensible à la case.</strong></p>
</div>
<div class="paragraph">
<p>Liste des variables mis à disposition pour chaque tâche :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File : Chemin complet du fichier (dossier + nom). <em>Exemple : "C:/scan-data/scaner-1/456456.tif"</em>,</p>
</li>
<li>
<p>FileName : Nom du fichier. <em>Exemple : "456456.tif"</em>,</p>
</li>
<li>
<p>FilePath : Chemin du dossier du fichier <em>Exemple : "C:/scan-data/scaner-1"</em>,</p>
</li>
<li>
<p>ReturnValue : Contient la valeur retourné par la dernière tâche.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_bases_du_macro_langage"><span class="navy">Bases du macro langage</span></h3>
<div class="paragraph">
<p>Les expressions du langage de macro sont toujours constituées soit d’un nom ou d’un nom suivi de parenthèses. Il ne supporte pas les expressions de type "a+b" et il ne supporte pas d’opérateur d’affectation (sauf au travers de la macro @Set() )
Le macro langage supporte les chaines de caractères en les entourant de guillemets ou simple quotes.</p>
</div>
<div class="listingblock">
<div class="title">Exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">"ma chaine"
'ma chaine'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntaxe_des_fonctions"><span class="navy">Syntaxe des fonctions</span></h3>
<div class="paragraph">
<p>Le nom d’une fonction est précédé d’un arobase. Une fonction exécute un traitement.</p>
</div>
<div class="listingblock">
<div class="title">Exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@ma_fonction()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Une fonction peut accepter des paramètres. Dans ce cas, ils sont indiqués après le nom de la fonction, entre parenthèses, séparé par une virgule.</p>
</div>
<div class="listingblock">
<div class="title">Exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@ma_fonction( param1 , param2 )
@ma_fonction( param1 )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si un paramètre est une constante, il est toujours encadré par des quotes simples, que sa valeur soit numérique ou non. Si une chaîne de caractères contient une quote, il faut la faire précéder d’un anti-slash. @ma_fonction('texte\n bonjour','2','3')</p>
</div>
</div>
<div class="sect2">
<h3 id="_syntaxe_des_variables"><span class="navy">Syntaxe des variables</span></h3>
<div class="paragraph">
<p>Une variable représente une valeur numérique ou alphanumérique. Elle est composée de lettres de chiffres et du caractère "_". Elle commence soit par une lettre soit par "_". Les variables sons sensibles à la casse.</p>
</div>
<div class="listingblock">
<div class="title">Exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">ma_variable</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_macro_spéciale"><span class="navy">Macro spéciale</span></h3>
<div class="sect3">
<h4 id="_affectation_de_variable"><span class="navy">Affectation de variable</span></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">@Set( var1 , valeur1 , var2 , valeur2 , […​ , varN , valeurN , varN+1 , valeurN+1 ] , valeur_de_retour )</dt>
<dd>
<p>Affectation à la variable retournée par var1 (resp: var2).<br>
La valeur retournée par valeur1 (resp: valeur2)<br>
Puis retourne la valeur donnée par valeur_de_retour.</p>
</dd>
<dt class="hdlist1">@Get( varname )</dt>
<dd>
<p>Retourne la valeur de l’expression <code>varname</code>.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@Get( @concat( "ma" , "variable" ) )
@Call( env , macro , param1 […​ , paramN] )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dans l’environnement env, on évalue la macro retournée par macro en lui donnant les arguments param1 à paramN.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@EvalMacro( macro ) </dt>
<dd>
<p>Exécute la macro passée en arguments.</p>
</dd>
<dt class="hdlist1">@EvalMacro( file , charset )</dt>
<dd>
<p>Charge puis évalue la macro se trouvant dans le fichier file de jeux de caractères charset.<br>
Les valeurs communes de charset sont "ISO-8859-1" (Linux), "ISO-8859-1" (Windows), "UTF-8" (universel).</p>
</dd>
<dt class="hdlist1">@exit()</dt>
<dd>
<p>Sort de la macro.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_opérations_conditionnelles"><span class="navy">Opérations conditionnelles</span></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">@true</dt>
<dd>
<p>Correspond à la valeur booléenne vraie.</p>
</dd>
<dt class="hdlist1">@false</dt>
<dd>
<p>Correspond à la valeur booléenne faux.</p>
</dd>
<dt class="hdlist1">@If( condition1 , expression1 […​ , conditionN , expressionN ] , defaut )</dt>
<dd>
<p>Si <code>condition1</code> est vrai, <code>expression1</code> est évaluée.<br>
Sinon, si <code>condition2</code> est vrai, <code>expression2</code> est évaluée et ainsi de suite.<br>
Si aucune condition n’est vraie, <code>defaut</code> est évalué.</p>
</dd>
<dt class="hdlist1">@IsEmpty( expression1 )</dt>
<dd>
<p>Retourne vrai si <code>expression1</code> est une chaîne vide ou une valeur Null.</p>
</dd>
<dt class="hdlist1">@IsNull( expression1 )</dt>
<dd>
<p>Retourne vrai si <code>expression1</code> est une chaîne vide ou une valeur Null.</p>
</dd>
<dt class="hdlist1">@IsNotEmpty( expression1 )</dt>
<dd>
<p>Retourne la valeur faux si <code>expression1</code> est une chaîne vide ou une valeur Null.</p>
</dd>
<dt class="hdlist1">@IfEmpty( expression1 , defaultValue )</dt>
<dd>
<p>Retourne la valeur <code>defaultValue</code> si <code>expression1</code> est une chaîne vide ou une valeur Null.<br>
Sinon retourne <code>expression1</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_opérateurs_logiques"><span class="navy">Opérateurs logiques</span></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">@Not( expression )</dt>
<dd>
<p>Expression doit être de type booléen.<br>
Si <code>expression</code> est vrai, retourne faux.<br>
Si <code>expression</code> est faux, retourne vrai.</p>
</dd>
<dt class="hdlist1">@And( expression1 , expression2 )</dt>
<dd>
<p><code>expression1</code> et <code>expression2</code> doivent être de type booléen.<br>
Effectue un "et / &amp;" logique entre les deux expressions.<br>
Si <code>expression1</code> et <code>expression2</code> sont vrais, alors vrai est retourné.<br>
Dans tous les autres cas, faux est retourné.</p>
</dd>
<dt class="hdlist1">@Or( expression1 , expression2 )</dt>
<dd>
<p><code>expression1</code> et <code>expression2</code> doivent être de type booléen.<br>
Effectue un "ou / ||" logique entre les deux expressions.<br>
Si <code>expression1</code> et <code>expression2</code> sont faux, alors faux est retourné.<br>
Dans tous les autres cas, vrai est retourné.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_boucle_dans_une_macro"><span class="navy">Boucle dans une macro</span></h4>
<div class="dlist">
<dl>
<dt class="hdlist1">@Do( arg1 […​ , argN ] )</dt>
<dd>
<p>Exécute les macros <code>arg1</code> à <code>argN</code>.<br>
Puis retourne la valeur de <code>argN</code>.</p>
</dd>
<dt class="hdlist1">@While( condition , arg1[…​ , argN ] )</dt>
<dd>
<p>Tant que la condition condition retourne vrai<br>
Exécute les macros <code>arg1</code> à <code>argN</code><br>
Puis retourne la valeur de <code>argN</code>.</p>
</dd>
<dt class="hdlist1">@DoWhile( arg1 […​ , argN ] )</dt>
<dd>
<p>Exécute les macros <code>arg1</code> à <code>argN</code>, puis tant que la condition condition est vraie réitère l’exécution de <code>arg1</code> à <code>argN</code>. Puis retourne la dernière valeur évaluée.</p>
</dd>
<dt class="hdlist1">@ForEach( varname , array , eval1 […​ , evalN ] )</dt>
<dd>
<p>Affecte à la valeur retournée par varname chaque élément de array, puis évalue les expressions eval1 à evalN</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_instruction_ditération_de_texte"><span class="navy">Instruction d’itération de texte</span></h4>
<div class="paragraph">
<p>Les macros suivantes permettent d’itérer le texte compris dans leur <strong>espace</strong> <code>$@End$</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">$@Begin( environnement , debut , max )$</dt>
<dd>
<p>Les variables <code>debut</code> et <code>max</code> sont optionnelles. Cette fonction s’utilise dans un environnement contenant des informations sous forme de liste. Cette liste est parcourue à partir de l’enregistrement indiqué par debut (numérotation commençant à 0) jusqu’à l’enregistrement debut + max. ou à concurrence du dernier enregistrement.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Syntaxe à respecter :</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">$@Begin( environnement , debut , max )$
&lt;!-- texte à générer --&gt;
$@End$</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p>Le code compris entre $@Begin( […​] )$ et $@End$ est répété pour chaque enregistrement dans la page HTML retournée.<br>
À noter également que environnement est considéré comme l’environnement par défaut : il n’est donc pas nécessaire de le préciser lorsqu’on utilise des fonctions ou variables de cet environnement, sauf pour lever une ambiguïté.<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Cet exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">$@Begin( @mon_environnement , 5 , 10 )$
Il pleut,&lt;br&gt;
$@End$</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Génère le texte suivant :</div>
<div class="content">
<pre>Il pleut,&lt;br&gt;
Il pleut,&lt;br&gt;
Il pleut,&lt;br&gt;
Il pleut,&lt;br&gt;
Il pleut,&lt;br&gt;
Il pleut,&lt;br&gt;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">$@BeginWhile( environnement , condition )$ <em>texte</em> $@End$</dt>
<dd>
<p>Tant que la condition condition est vraie, itère le texte text.</p>
</dd>
<dt class="hdlist1">$@BeginCache( varName )$ <em>texte</em> $@End$</dt>
<dd>
<p>Affecte à la variable retournée par varName le texte texte.</p>
</dd>
<dt class="hdlist1">$@BeginIf( env , condition1 )$ <em>texte1</em> $@ElseIf( condition2 )$ <em>texte2</em> $@Else$ <em>texte3</em> $@End$</dt>
<dt class="hdlist1"></dt>
<dd>
<p>Affiche le texte text1 si la condition condition1 est vraie, sinon affiche le texte texte2 si la condition condition2 est vraie, sinon affiche le texte texte3.
   Les clauses @ElseIf et @Else sont optionnelles.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Cet exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">$@BeginIf( environnement , condition1 )$
&lt;!-- texte à afficher --&gt;
$@ElseIf( condition2 )$
&lt;!-- texte à afficher --&gt;
$@Else$
&lt;!-- texte à afficher par défaut --&gt;
$@End$</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Information</div>
<div class="ulist">
<ul>
<li>
<p>Bien entendu, vous pouvez mettre autant de @ElseIf que nécessaire et un seul $@Else$.</p>
</li>
<li>
<p><code>environnement</code> est considéré comme l’environnement par défaut : il n’est donc pas nécessaire de le préciser lorsqu’on utilise des fonctions ou variables de cet environnement <code>env</code>, sauf pour lever une ambiguïté.</p>
</li>
<li>
<p>Vous pouvez omettre l’environnement <code>env</code> en écrivant <code>$@Begin( condition1 )$</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">$@BeginIfNot( environnement , condition )$</dt>
<dd>
<p>Idem à $@BeginIf()$ mais lorsque la condition est fausse.</p>
</dd>
<dt class="hdlist1">$@BeginElseIf()$</dt>
<dd>
<p>Est un équivalent de $@ElseIf()$</p>
</dd>
<dt class="hdlist1">$@BeginElseIfNot()$</dt>
<dd>
<p>Est un équivalent de $@ElseIfNot()$</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_les_fonctions"><span class="navy">Les fonctions</span></h3>
<div class="sect3">
<h4 id="_fonctions_de_base_environnement"><span class="navy">Fonctions de base (environnement @)</span></h4>
<div class="sect4">
<h5 id="_fonctions_sur_les_chaînes"><span class="navy">Fonctions sur les chaînes</span></h5>
<div class="paragraph">
<p>Ce qui est entre crochets est optionnel.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@Length( chaine )</dt>
<dd>
<p>Cette fonction retourne alors la longueur de la chaîne <code>chaine</code>.</p>
</dd>
<dt class="hdlist1">@Left( chaine , nbCaracteres )</dt>
<dd>
<p>nbCaracteres doit être une expression de type numérique. Retourne les nbCaracteres caractère de la chaîne <code>chaine</code> à partir de sa gauche.</p>
</dd>
<dt class="hdlist1">@Right( chaine , nbCaracteres )</dt>
<dd>
<p>nbCaracteres doit être une expression de type numérique. Retourne les nbCaracteres caractère de la chaîne <code>chaine</code> à partir de sa droite.</p>
</dd>
<dt class="hdlist1">@Mid( chaine , debut [, fin ] )</dt>
<dd>
<p>Début et fin doivent être des expressions de type numérique. Cette fonction retourne la portion de la chaîne <code>chaine</code> depuis le caractère indiqué par debut (la numérotation commence à 0) jusqu’au caractère indiqué par fin (exclus). Si fin est omis, la portion de texte commence à debut jusqu’à la fin de la chaîne.</p>
</dd>
<dt class="hdlist1">@Trim( chaine )</dt>
<dd>
<p>Retourne la chaîne <code>chaine</code> après lui avoir supprimé les espaces de droite et gauche.</p>
</dd>
<dt class="hdlist1">@Replace( chaine1 , chaine2 , chaine3 )</dt>
<dd>
<p>Remplace la chaîne <code>chaine2</code> par la chaîne <code>chaine3</code> dans la chaîne <code>chaine1</code>.</p>
</dd>
<dt class="hdlist1">@ToLowerase( expression )</dt>
<dd>
<p>Retourne la chaîne expression convertit en minuscules.</p>
</dd>
<dt class="hdlist1">@ToUppercase( expression )</dt>
<dd>
<p>Retourne la chaîne expression convertit en majuscules.</p>
</dd>
<dt class="hdlist1">@Capitalize( expression )</dt>
<dd>
<p>Retourne la chaîne expression capitalisée : 1 lettre en majuscule, le reste des lettres est inchangé.</p>
</dd>
<dt class="hdlist1">@Contain( val , arg1 [… ​, argK ] )</dt>
<dd>
<p>Retourne la première valeur de <code>arg1</code> à <code>argK</code> qui contient la valeur <code>val</code>.</p>
</dd>
<dt class="hdlist1">@GenerateRandomString( taille )</dt>
<dd>
<p>Retourne une chaîne tirée au hasard de taille taille. Si la taille taille est omise, retourne une chaîne de taille 8.</p>
</dd>
<dt class="hdlist1">@Concat( expression1 [, expressionN …​ ] )</dt>
<dd>
<p>Concatène les différentes chaînes <code>expression1</code> à expressionN.</p>
</dd>
<dt class="hdlist1">@Concat2( séparateur , expression1 [… , expressionN ] )</dt>
<dd>
<p>Concatène les différentes chaînes <code>expression1</code> à expressionN en les séparant par séparateur. Les chaînes vides ou nulles sont ignorées.</p>
</dd>
<dt class="hdlist1">@Transpose( expression1 , expression2 [, expression3 ] )</dt>
<dd>
<p>Retourne une chaîne après avoir remplacé dans la chaîne <code>expression1</code>, chaque caractère de la chaîne <code>expression2</code> par le caractère correspondant de la chaîne <code>expression3</code>.
S’il n’y a pas de correspondance, le caractère est supprimé.
Si <code>expression3</code> n’est pas renseigné, tous les caractères de <code>expression2</code> trouvés dans <code>expression1</code> sont supprimés.
S’il y a plus de caractères dans <code>expression3</code> que dans <code>expression2</code>, les caractères de <code>expression3</code> situés au-delà de la longueur de <code>expression2</code> sont ignorés.
la fonction est sensible à la casse.</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Exemples d&#8217;utilisation de @Transpose</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Résultat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Transpose("abcdef", "b" , "Z")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">aZcdef</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Transpose("abcdef", "bdf" , "ZZZ")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">aZcZeZ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Transpose("abcdef", "bdf")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Transpose("abcdef", "bdf" , "ZZ")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">aZcZe</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">@Split( val, regexp [, nb ] )</dt>
<dd>
<p>Retourne le tableau résultant du découpage de la chaîne val en utilisant l’expression régulière regexp comme séparateur.</p>
</dd>
<dt class="hdlist1"></dt>
<dd>
<p>Affiche le texte text1 si la condition condition1 est vraie, sinon affiche le texte texte2 si la condition condition2 est vraie, sinon affiche le texte texte3.
   Les clauses @ElseIf et @Else sont optionnelles.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemple 1 :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">$@Split( "toto,titi;tutu" , "[,;]" )$</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Génère le résultat suivant :</div>
<div class="content">
<pre>["toto","titi","tutu"]</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p>L&#8217;exemple 2 utilise le nombre nb qui indique la taille maximale du tableau à retourner.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemple 2 :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">$@Split( "toto,titi;tutu" , "[,;]" , '1' )$</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Génère le résultat suivant :</div>
<div class="content">
<pre>["toto"],["titi","tutu"]</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p>En combinaison avec @Implode() on peut éliminer certaines parties d’une chaîne.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemple 3 :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@Implode(
@Split("Info:mon info;ceci est le résumé qui utilise aussi le ';' dans son texte !", ";", 2) ,
" " , -1)</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Génère le résultat suivant :</div>
<div class="content">
<pre>"ceci est le résumé qui utilise aussi le ';' dans son texte !"</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@ReplaceKey( expression )</dt>
<dd>
<p>Remplace les variables se trouvant entre-deux "%" dans la chaîne expression. Les variables sont prises dans l’environnement actuel. S’il y a deux "%" consécutif ("%%") alors il est remplacé par un seul "%".
La variable peut commencer par une directive de conversion :</p>
<div class="ulist">
<ul>
<li>
<p>(html) : convertit en HTML la valeur de la variable</p>
</li>
<li>
<p>(html:br) : convertit en HTML la valeur de la variable, en remplaçant les retours chariot par "&lt;br&gt;"</p>
</li>
<li>
<p>(url) : convertit au format URL une variable (urlEncode). Par défaut, utilise le jeu de caractères UTF-8</p>
</li>
<li>
<p>(url:utf8) : convertit au format URL une variable (urlEncode). En utilisant le jeu de caractère se trouvant après les deux points si présents. sinon utf8</p>
</li>
<li>
<p>(#url) : décode la variable "urlEncode" en chaîne. C’est le contraire d’URL</p>
</li>
<li>
<p>(js) : convertit en chaîne JavaScript la valeur de la variable</p>
</li>
<li>
<p>(jshtml) : convertit en chaîne JavaScript et HTML la valeur de la variable</p>
</li>
<li>
<p>(sql) : convertit en chaîne SQL la valeur de la variable</p>
</li>
<li>
<p>(sqllike) : convertit en chaîne SQL et like la valeur de la variable</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemple avec <code>valeur</code> valant "L’espadon" :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@ReplaceKey("ma %(html)valeur%")</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Génère le résultat suivant :</div>
<div class="content">
<pre>"ma L&amp;quote;espadon"</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@Filter( val , regexp )</dt>
<dd>
<p>Si val est un tableau, retourne un tableau contenant chaque valeur du tableau dont les chaînes contiennent la forme exprimée par l’expression régulière regexp .<br>
Sinon, si val contient la forme exprimée par l’expression régulière regexp, elle est retournée.</p>
</dd>
<dt class="hdlist1">@Substring( chaine1 [, regexp ] [, numGroup ] [, devaultValue ] )</dt>
<dd>
<p>Extrait de la chaîne <code>chaine1</code>, la chaîne donnée par le numéro de groupe numGroup de l’expression régulière regexp.<br>
Si aucune sous-chaîne n’est trouvée alors la chaîne devaultValue est retournée (par défaut la chaîne vide)</p>
</dd>
<dt class="hdlist1">@SelectInList( expression , liste , defaut [, séparateur ] )</dt>
<dd>
<p>La chaîne <code>expression</code> est retournée si elle existe dans la liste <code>liste</code>.<br>
Sinon c’est défaut qui est renvoyé. La variable liste est une chaîne représentant une liste de chaînes, séparées par un caractère (par défaut, la virgule ou le point-virgule). D’autres séparateurs peuvent être indiqués via le paramètre séparateur.</p>
</dd>
<dt class="hdlist1">@ReplaceRegEx( chaine1 , regexp , chaineDeRemplacement )</dt>
<dd>
<p>Remplace dans <code>chaine</code> les sous-chaînes répondant à l’expression régulière regexp par la valeur de chaineDeRemplacement</p>
</dd>
<dt class="hdlist1">@IndexOf( val , expression )</dt>
<dd>
<p>Retourne l’index de la chaîne val dans la chaîne <code>expression</code><br>
Sinon retourne faux.</p>
</dd>
<dt class="hdlist1">@LastIndexOf( val , expression )</dt>
<dd>
<p>Retourne le dernier index de la chaîne val dans la chaîne <code>expression</code><br>
Sinon retourne faux.</p>
</dd>
<dt class="hdlist1">@Implode( tableau , 'separator' [, nbElement ] )</dt>
<dd>
<p>Retourne la concaténation du tableau de valeur <code>tableau</code> en utilisant comme séparateur la chaîne &#8216;separator&#8217; .
Si <code>nbElement</code> est supérieure à zéro cette fonction ne concatène que les <code>nbElement</code> première valeur du tableau 'tableau'.
Si <code>nbElement</code> est négatif, la concaténation ne s’effectue que sur les <code>nbElement</code> dernière valeur du tableau tableau.</p>
</dd>
<dt class="hdlist1">@RepeatString( chaine , nb )</dt>
<dd>
<p>Retourne une chaîne contenant <code>nb</code> fois la chaîne <code>chaine</code> ou une chaîne vide.</p>
</dd>
<dt class="hdlist1">@FilterExtract( val , regexp [, iExtract] )</dt>
<dd>
<p>Si <code>val</code> est un tableau, il retourne un tableau avec les éléments du tableau orignal qui correspond à l’expression régulière <code>regexp</code>.<br>
Sinon il convertit <code>val</code> en une chaîne, puis retourne la valeur correspondant à l’expression régulière <code>regexp</code>.<br>
Si <code>iExtract</code> vaut zéro (défaut), il retourne toute la chaîne.<br>
Sinon il retourne la partie correspondant au groupe <code>iExtract</code> de l’expression régulière.</p>
</dd>
<dt class="hdlist1">@ElementAt( data , iPosition , défaut )</dt>
<dd>
<p>Retourne l’élément se trouvant à la position <code>iPosition</code> de l’objet <code>data</code>.</p>
<div class="literalblock">
<div class="content">
<pre>   Si `data` est un tableau retourne l’élément iPosition. +
   Si `data` n’est pas un tableau, il est convertit en chaîne puis retourne le caractère se trouvant à la position `iPosition`. +
Si la position iPosition est hors contexte, retourne défaut si existe sinon faux.</pre>
</div>
</div>
</dd>
<dt class="hdlist1">@SelectValueInMap( key , map [, defaut ] [, separator ] [, affectation ] [, casseSensitif ] )</dt>
<dd>
<p>Retourne la valeur dans la carte <code>map</code> correspondant à chaîne key.<br>
La chaîne <code>map</code> doit avoir un format particulier de la forme "clé1=valeur;clé2=valeur2".
Le paramètre <code>defaut</code> est la valeur à retourner si la clé n’est pas trouvée.
Le paramètre <code>separator</code> est le symbole de séparation de couple (clé,valeur). Par défaut c’est le ";".
Le paramètre <code>affectation</code> est le symbole séparant la clé de sa valeur. Par défaut c’est le "="
Le paramètre <code>casseSensitif</code> indique si la recherche de clé est sensible à la casse</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemples :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@SelectValueInMap( chaîneArechercher , listeElement , "val de default" , separator=";" , affectation="=" , isCaseSensitif)
@SelectValueInMap( "toto" , "A=1;toto=2" , "default" , ",;" , "=" , isCaseSensitif )
@SelectValueInMap( "toto" , "A=1;toto=2" )</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fonctions_de_comparaison"><span class="navy">Fonctions de comparaison</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@Compare( val1 , val2 [, caseInsensitive ] )</dt>
<dd>
<p>Compare les deux chaînes <code>val1</code> et <code>val2</code>. Retourne :</p>
<div class="ulist">
<ul>
<li>
<p>0, si <code>val1</code> et <code>val2</code> sont egaux.</p>
</li>
<li>
<p>-1, si <code>val1</code> est plus petit que <code>val2</code>.</p>
</li>
<li>
<p>+1, si <code>val1</code> est plus grand que <code>val2</code>.
La comparaison est sensible à la casse si caseInsensitive est vrai.<br>
Par défaut la comparaison est sensible à la casse.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">@Equal( nombre1 , nombre2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>nombre1</code> est égal au nombre <code>nombre2</code>.<br>
Sinon faux.
Cette fonction convertit ces arguments en nombre avant comparaison.</p>
</dd>
<dt class="hdlist1">@Contain( val , expression1 [… , expressionN ] )</dt>
<dd>
<p>Retourne la chaîne de <code>expression</code> à <code>expressionN</code> qui contient val.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@Cmp( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si les deux chaînes <code>val1</code> et <code>val2</code> sont identiques ou nulles.</p>
</dd>
<dt class="hdlist1">@IsInString( val , expression )</dt>
<dd>
<p>Retourne vrai si la valeur de val est dans la chaîne <code>expression</code>.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@IsEmpty( expression )</dt>
<dd>
<p>Retourne vrai si la valeur de <code>expression</code> est vide, ou nulle.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@HasEmpty( expression )</dt>
<dd>
<p>Idem que <code>@IsEmpty</code>.</p>
</dd>
<dt class="hdlist1">@IsNotEmpty( expression )</dt>
<dd>
<p>Retourne vrai si la valeur de <code>expression</code> est vide.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@IsTrue( expression )</dt>
<dd>
<p>Retourne vrai si la valeur de <code>expression</code> est vraie.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@IsFalse( expression )</dt>
<dd>
<p>Retourne vrai si la valeur de <code>expression</code> est faux.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@StartWith( val , begin )</dt>
<dd>
<p>Retourne vrai si la valeur de val commence par begin.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@EndWith( val , end )</dt>
<dd>
<p>Retourne vrai si la valeur de val commence par end.<br>
Sinon faux.</p>
</dd>
<dt class="hdlist1">@Match( val , regexp )</dt>
<dd>
<p>Retourne vrai, si val valide l’expression régulière <code>regexp</code>.<br>
Sinon retourne faux.</p>
</dd>
<dt class="hdlist1">@IsInList( expression , liste [, separateurs ] )</dt>
<dd>
<p>Retourne vrai si la chaîne de <code>expression</code> est présente dans la liste <code>liste</code>.<br>
<code>liste</code> étant une suite de chaînes de caractères, séparées par le caractère separateurs (par défaut la virgule ou le point-virgule, si non présent).</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemple :</div>
<div class="content">
<pre class="highlight"><code class="language-macro" data-lang="macro">@IsInList( "doc" , "doc;HTML;htm;txt" )</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Génère le résultat suivant :</div>
<div class="content">
<pre>true</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fonctions_de_trace"><span class="navy">Fonctions de trace</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@Print( expression1, [… , expressionN ] )</dt>
<dd>
<p>Affiche sur la sortie standard les valeurs <code>expression1</code> à <code>expressionN</code>.</p>
</dd>
<dt class="hdlist1">@Println( expression1, [… , expressionN​ ] )</dt>
<dd>
<p>Affiche sur la sortie standard les valeurs <code>expression1</code> à <code>expressionN</code>, suivies d’une fin de ligne.</p>
</dd>
<dt class="hdlist1">@Debug( expression1, [, expressionN …​ ] )</dt>
<dd>
<p>Affiche sur la sortie standard les valeurs <code>expression1</code> à <code>expressionN</code>, suivies d’une fin de ligne.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_fonctions_de_conversion"><span class="navy">Fonctions de conversion</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@ToString( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en une chaîne.</p>
</dd>
<dt class="hdlist1">@ToFloat( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en un nombre de type "float".</p>
</dd>
<dt class="hdlist1">@ToDouble( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en un nombre de type "double".</p>
</dd>
<dt class="hdlist1">@ToInteger( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en un nombre entier de type "integer" (32bit).</p>
</dd>
<dt class="hdlist1">@ToLong( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en un nombre de type "long" (64 bit).</p>
</dd>
<dt class="hdlist1">@ToDate( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en une date.<br>
Si <code>expression</code> est de type nombre, il est considéré comme étant le nombre de miliseconde depuis le 1/1/1970 (epoc).<br>
Si <code>expression</code> est de type chaîne, c’est une date de format "yyyy/MM/dd" ou "yyyy-MM-dd" ou "dd/MM/yyyy" de type "dd-MM-yyyy".</p>
</dd>
<dt class="hdlist1">@ToEnvironnement( expression ) <strong>OU</strong> @ToEnv( expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> en un environnement. Cela permet par la suite de l’itérer dans <code>$@Begin()$</code>.
Suivant le type de <code>expression</code> :</p>
<div class="ulist">
<ul>
<li>
<p>Cas 1 : si un seul argument qui n’est pas un tableau il est convertit en SimpleEnvironnemnt. ce qui permet d’accéder à toutes ces méthodes publiques.</p>
</li>
<li>
<p>Cas 2 : si le 2ème paramètre contient "field", "getter" ou "map", le nom des champs sur les variables publiques, méthode getter ou sur les noms "F0" à "fxx".</p>
</li>
<li>
<p>Cas 3 : si le paramètre 0 contient "header", alors un paramètre sur 2 qui suit contient le nom de la colonne et 1 sur 2 contient le tableau de la colonne. Sinon le nom de chaque colonne est F0 à Fk.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Exemples :</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!-- Cas 1 --&gt;
$@Begin( @ToEnvironnement( "," ) )$ $F0$ $@End$
$@Begin( @ToEnvironnement( "," , @true ) )$ $F0$ $@End$
$@Begin( @ToEnvironnement( @Split( "v1,v2,v3" , "," ) ) )$ $F0$ $@End$
&lt;! Cas 3 --&gt;
$@Begin( @ToEnvironnement( "Header" , "Champ1" , @Split( "v1,v2,v3" , "," ) , "Champ2" , @Split( "w1,w2,w3" , "," ) ) )$ $Champ1$-$Champ2$ $@End$</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@to( type , expression )</dt>
<dd>
<p>Convertit la valeur de <code>expression</code> dans le type indiqué par type.<br>
Les différentes valeurs de <code>type</code> sont : date, float, double, integer, long, environnement, string.</p>
</dd>
<dt class="hdlist1">@Format( chaine , format [, default ] [, local ] [, nbChar ] [, align ] [, charEmpty ] )</dt>
<dd>
<p>Retourne la chaîne <code>chaine</code> formatée avec le format format suivant la local local (ex FR, FR/FR).<br>
La chaîne obtenue doit faire nbChar caractères si présent.<br>
Elle est alignée à droite si align vaut "right", à gauche si align vaut "left".<br>
charEmpty est le caractère servant à compléter la chaîne de sortie.<br>
Pour le format de format voir dans les dates @FormatDate et les nombres @FormatNumber<br></p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_fonctions_mathématiques"><span class="navy">Fonctions mathématiques</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@Sum( val1 [, valN …​ ] )</dt>
<dd>
<p>Retourne la somme des valeurs de <code>val1</code> à valN
Si une des valeurs est une chaîne, elle est convertit en nombre avant de faire la somme.
Si la conversion est impossible, elle est ignorée.</p>
</dd>
<dt class="hdlist1">@Plus( val1 [, valN …​ ] )</dt>
<dd>
<p>Retourne la somme des valeurs de <code>val1</code> à valN</p>
</dd>
<dt class="hdlist1">@Add( val1 [, valN …​ ] )</dt>
<dd>
<p>Retourne la somme des valeurs de <code>val1</code> à valN</p>
</dd>
<dt class="hdlist1">@Minus( val1 [, valN …​ ] )</dt>
<dd>
<p>Retourne la soustraction de la valeur <code>val1</code> moins valN</p>
</dd>
<dt class="hdlist1">@Mult( nombre1 , nombre2 )</dt>
<dd>
<p>Retourne le résultat de la multiplication du nombre <code>nombre1</code> par le nombre <code>nombre2</code></p>
</dd>
<dt class="hdlist1">@Divide( nombre1 , nombre2 )</dt>
<dd>
<p>Retourne le résultat de la division du nombre <code>nombre1</code> par le nombre <code>nombre2</code></p>
</dd>
<dt class="hdlist1">@Div( nombre1 , nombre2 )</dt>
<dd>
<p>Retourne le reste de la division de <code>nombre1</code> par <code>nombre2</code>.</p>
</dd>
<dt class="hdlist1">@Modulo( number , modulo )</dt>
<dd>
<p>Retourne-le modulo modulo du nombre number.</p>
</dd>
<dt class="hdlist1">@Dec( expression )</dt>
<dd>
<p>Retourne la valeur de <code>expression</code> décrémentée de 1.</p>
</dd>
<dt class="hdlist1">@Inc( expression )</dt>
<dd>
<p>Retourne la valeur de <code>expression</code> incrémentée de 1.</p>
</dd>
<dt class="hdlist1">@neg( val1 )</dt>
<dd>
<p>Retourne le négatif de <code>val1</code>.</p>
</dd>
<dt class="hdlist1">@Superior( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>val1</code> est supérieur au nombre <code>val2</code></p>
</dd>
<dt class="hdlist1">@SuperiorEqual( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>val1</code> est supérieur ou égal au nombre <code>val2</code></p>
</dd>
<dt class="hdlist1">@Superior0( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>val1</code> est supérieur ou égal au nombre <code>val2</code></p>
</dd>
<dt class="hdlist1">@Inferior( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>val1</code> est inférieur au nombre <code>val2</code></p>
</dd>
<dt class="hdlist1">@InferiorEqual( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>val1</code> est inférieur ou égal au nombre <code>val2</code></p>
</dd>
<dt class="hdlist1">@Inferior0( val1 , val2 )</dt>
<dd>
<p>Retourne vrai si le nombre <code>val1</code> est inférieur ou égal au nombre <code>val2</code></p>
</dd>
<dt class="hdlist1">@max( val1 , val2 )</dt>
<dd>
<p>Retourne le plus grand des nombres <code>val1</code> à <code>val2</code></p>
</dd>
<dt class="hdlist1">@min( val1 , val2 )</dt>
<dd>
<p>Retourne le plus petit des nombres <code>val1</code> à <code>val2</code></p>
</dd>
<dt class="hdlist1">@abs( val )</dt>
<dd>
<p>Retourne la valeur absolue du nombre <code>val</code></p>
</dd>
<dt class="hdlist1">@Ceil( val )</dt>
<dd>
<p>Retourne le nombre entier directement supérieur ou égal au nombre <code>val</code></p>
</dd>
<dt class="hdlist1">@Floor( val )</dt>
<dd>
<p>Retourne le nombre entier directement inférieur ou égal au nombre <code>val</code></p>
</dd>
<dt class="hdlist1">@Round( val )</dt>
<dd>
<p>Retourne le nombre entier directement supérieur ou égal du nombre <code>val</code></p>
</dd>
<dt class="hdlist1">@formatNumber( number , format )</dt>
<dd>
<p>Convertit le nombre <code>number</code> en une chaîne correspondant au format <code>format</code>.</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Exemples d&#8217;utilisation de @formatNumber</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Format de sortie</th>
<th class="tableblock halign-left valign-top">Résultat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#.#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#.00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">123456789</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#,###,###</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.456.789</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12%</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Il est possible de prendre en compte les caractéristiques locales à un pays et/ou une langue en renseignant les paramètres localisationEntrée et localisationSortie. Leurs valeurs peuvent influencer le séparateur décimal ou de milliers par exemple. Les deux paramètres ont la même syntaxe : "langue/PAYS"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>localisationEntrée : indique les règles du pays et/ou de la langue dans lesquelles la valeur numérique est exprimée.</p>
</li>
<li>
<p>localisationSortie : indique les règles du pays et/ou de la langue dans lesquelles la valeur numérique sera formatée.
Nous n’indiquerons pas ici la liste de toutes les langues et pays (plusieurs centaines de lignes). Sachez que pour le format français, le code est fr/FR et que pour le format anglais, le code est en/EN.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Exemples d&#8217;utilisation de @formatNumber en fonction du modèle Anglais/Français</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Format de sortie</th>
<th class="tableblock halign-left valign-top">Localisation Entrée</th>
<th class="tableblock halign-left valign-top">Localisation Sortie</th>
<th class="tableblock halign-left valign-top">Résultat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#.#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en/EN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fr/FR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123,1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#.#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en/EN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en/EN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">123456789</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#,###,###</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en/EN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fr/FR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123 456 789</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#,###,###</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en/EN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en/EN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123,456,789</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_manipulations_de_dates"><span class="navy">Manipulations de dates</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@Date</dt>
<dd>
<p>Retourne la date actuelle. La date peut être formatée par la fonction @FormatDate.</p>
</dd>
<dt class="hdlist1">@Date( temps_en_ms )</dt>
<dd>
<p>Retourne la date <code>temps_en_ms</code> exprimée en millisecondes depuis le 1er janvier 1970.</p>
</dd>
<dt class="hdlist1">@Date( année , mois , jour )</dt>
<dd>
<p>Retourne la date correspondant à jour/mois/année.</p>
</dd>
<dt class="hdlist1">@Date( année , mois , jour , heure , minute , seconde )</dt>
<dd>
<p>Retourne la date correspondant à jour/mois/année heure:minute:seconde.</p>
</dd>
<dt class="hdlist1">@Dateadd( date , année , mois , jour , heure ,  minute , seconde,  milliseconde )</dt>
<dd>
<p>Retourne la date résultat de l’addition à la date <code>date</code> et le temps donné par les valeurs positives ou négatives <code>année</code>, <code>mois</code>, <code>jour</code>, <code>heure</code>, <code>minute</code>, <code>seconde</code>, <code>milliseconde</code>.</p>
</dd>
<dt class="hdlist1">@DateAge( date [, defaut ] )</dt>
<dd>
<p>Retourne le nombre d’années entre la date <code>date</code> et maintenant. Retourne defaut ou faux si <code>date</code> n’est pas une date.</p>
</dd>
<dt class="hdlist1">@DateField( type , date )</dt>
<dd>
<p>La valeur <code>date</code> doit être une date.
Suivant la valeur de type parmi les chaînes suivantes :</p>
<div class="ulist">
<ul>
<li>
<p>"YEAR" : retourne l’année</p>
</li>
<li>
<p>"MONTH" : retourne le numéro de mois : 1 à 12</p>
</li>
<li>
<p>"DATE" : retourne le jour de la date 1 à 31</p>
</li>
<li>
<p>"HOUR" : retourne l’heure basée sur 24</p>
</li>
<li>
<p>"MINUTE" : retourne les minutes</p>
</li>
<li>
<p>"SECOND" : retourne les secondes</p>
</li>
<li>
<p>"MILLISECOND" : retourne les millisecondes</p>
</li>
<li>
<p>"WEEK_OF_MONTH" : retourne la semaine du mois</p>
</li>
<li>
<p>"DAY_OF_YEAR" : retourne le jour de l’année</p>
</li>
<li>
<p>"WEEK_OF_YEAR" : retourne la semaine de l’année</p>
</li>
<li>
<p>"DAY_OF_WEEK" : retourne le jour de la semaine basé sur dimanche pour 1er jour</p>
</li>
<li>
<p>"DAY_OF_WEEK_IN_MONTH" : retourne 1 pour 1er mardi du mois, 2 pour 2e …​
Sinon retourne FAUX.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">@FormatDate( date , format )</dt>
<dd>
<p>Convertit la date <code>date</code> en une chaîne correspondant au format format</p>
</dd>
<dt class="hdlist1">@FormatDate( date , formatIn , formatOut )</dt>
<dd>
<p>Convertit la chaîne <code>date</code> en une date (en utilisant le format <code>formatIn</code>) puis la convertit en une chaîne correspondant au format <code>format</code>.
Si <code>date</code> est déjà une date, elle est utilisée tel quel sans passer par le formatage de <code>formatIn</code>.</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Exemples d&#8217;utilisation de @formatDate</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbole</th>
<th class="tableblock halign-left valign-top">Signification</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ere</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Texte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Année</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mois dans l&#8217;année</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Texte et nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Juillet et 07</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jour dans le mois</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heure (de 1 à 12)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heure (de 0 à 23)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">k</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heure (de 1 à 24)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heure (de 0 à 11)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seconde</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">55</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">S</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconde</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">978</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jour de la semaine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Texte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mardi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jour dans l&#8217;année</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">189</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jour de la semaine dans le mois</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 (2ème mercredi de juillet)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Semaine dans l&#8217;année</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Semaine dans le mois</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nombre</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">am/pm (afficher le format heure)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Texte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fuseau horaire</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Texte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pacific Standard Time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caractère d&#8217;échappement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Séparateur</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quote simple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Littéral</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Le nombre de fois où le symbole est répété détermine le format final :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pour les symboles de type "Texte"</p>
<div class="ulist">
<ul>
<li>
<p>Si le symbole est indiqué au plus 3 fois, c’est la forme abrégée qui est affichée si elle existe.
Exemple : "E" affichera "mar."" pour mardi</p>
</li>
<li>
<p>Si le symbole est indiqué plus de 3 fois, c’est la forme complète qui est affichée.
Exemple : "EEEE" affichera "mardi"</p>
</li>
</ul>
</div>
</li>
<li>
<p>Pour les symboles de type "Nombre"
Indique le nombre minimum de chiffres.
    Par exemple pour le dixième jour du mois :</p>
<div class="ulist">
<ul>
<li>
<p>"d" affichera "10"</p>
</li>
<li>
<p>"dd" affichera "01"
  Cependant, pour les années, si on indique yy, seuls les deux derniers chiffres de l’année seront affichés.
Par exemple pour l’année 2002 :</p>
</li>
<li>
<p>"yy" affichera "02"</p>
</li>
<li>
<p>"yyyy" affichera "2002"</p>
</li>
</ul>
</div>
</li>
<li>
<p>Pour les symboles de type "Texte et Nombre"</p>
<div class="ulist">
<ul>
<li>
<p>Si le symbole est répété 3 fois et plus, c’est la règle des symboles de type "Texte" qui s’applique</p>
</li>
<li>
<p>Si le symbole est répété moins de 3 fois, c’est la règle des symboles de type "Nombre" qui s’applique
Par exemple pour le mois de février, "MM" affichera "02"; "MMM" affichera "fév." ** "MMMM" affichera "février"</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_fonctions_web"><span class="navy">Fonctions Web</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@UrlenCode( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne de type URL pour utilisation dans les paramètres d’une URI.</p>
</dd>
<dt class="hdlist1">@UrlDecode( expression )</dt>
<dd>
<p>Décode un paramètre d’URI en une chaîne. Contraire de @UrlEncode.</p>
</dd>
<dt class="hdlist1">@HtmlEncode( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne HTML.</p>
</dd>
<dt class="hdlist1">@HtmlDecode( expression )</dt>
<dd>
<p>Convertit la chaîne HTML <code>expression</code> en une chaîne. Contraire de @Htmlncode.</p>
</dd>
<dt class="hdlist1">@JSHtmlEncode( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne de type JavaScript dans du HTML.</p>
</dd>
<dt class="hdlist1">@JSEncode( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne JavaScript.</p>
</dd>
<dt class="hdlist1">@ReadUrlToString( url , charset )</dt>
<dd>
<p>Retourne la chaîne correspondant au fichier texte se trouvant sur l’URL url. Le flux de l’URL est lu avec le jeu de caractères charset.</p>
</dd>
<dt class="hdlist1">@URLTo( expression , type )</dt>
<dd>
<p>Extrait de l’URL <code>expression</code> une ou toute la chaîne représentant l’URL suivant le type type.
Les différentes valeurs de type (exemple d’URL : "http://monserver:8087/WindexGed/name?Param1=val&amp;Param2=val2#signe" )</p>
<div class="ulist">
<ul>
<li>
<p>file : retourne la partie fichier de l’URL. Exemple : "/WindexGed/name?Param1=val&amp;Param2=val2"</p>
</li>
<li>
<p>path : retourne la partie fichier de l’URL. Exemple : "/WindexGed/name"</p>
</li>
<li>
<p>query : retourne la partie fichier de l’URL. Exemple : "Param1=val&amp;Param2=val2"</p>
</li>
<li>
<p>rel : retourne la partie fichier de l’URL. Exemple : "signe"</p>
</li>
<li>
<p>port : retourne la partie port de l’URL. Exemple : "8087"</p>
</li>
<li>
<p>host : retourne la partie serveur de l’URL. Exemple : "monserver"</p>
</li>
<li>
<p>protocol : retourne la partie fichier de l’URL. Exemple : "http"</p>
</li>
<li>
<p>la chaîne représentant l’URL "http://monserver:8087/WindexGed/name?Param1=val&amp;Param2=val2#signe"</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">@FileToURL( surl )</dt>
<dd>
<p>Retourne l’objet de type URL que représente la chaîne surl.</p>
</dd>
<dt class="hdlist1">@HtmlEncode( expression [, séparateur ] )</dt>
<dd>
<p>Encode <code>expression</code>. En HTML, certains caractères sont traduits par une séquence d’un ou plusieurs caractères afin qu’ils n’entrent pas en conflit avec la syntaxe même du langage.<br>
Ainsi, si vous voulez afficher le caractère "&gt;", vous devrez écrire en HTML<br>
ou bien<br>
La fonction <code>@HtmlEncode</code> effectue cette conversion sur le contenu de l’expression qu’elle retourne.<br>
Elle est très utile lorsque vous affichez le contenu d’une variable dans la page HTML et que vous ne contrôlez pas forcément le contenu de cette variable.<br>
Si expression contient le caractère de saut de ligne ("\n"), il peut être remplacé par la valeur du séparateur séparateur. Ainsi, dans un document HTML, le saut à la ligne n’étant pas interprété, on peut par exemple le remplacer par la balise.</p>
</dd>
<dt class="hdlist1">@HtmlDecode( expression )</dt>
<dd>
<p>Décode la chaîne expression.<br>
Cette fonction est l’opposée de <code>@HtmlEncode</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_fonctions_diverses"><span class="navy">Fonctions diverses</span></h5>
<div class="dlist">
<dl>
<dt class="hdlist1">@AddInList( [ list [, exp1 […​ , expK ] ] ] )</dt>
<dd>
<p>Si aucun élément ne retourne une liste (Java ArrayList) vide.<br>
Si <code>list</code> est une liste (au sens Collection de Java), alors les éléments de exp1 a expK y seront ajoutés.<br>
Si <code>list</code> est nul ou n’est pas une liste (au sens Collection de Java), alors une liste est créé , puis les éléments <code>list</code>, <code>exp1</code> à <code>expK</code> y sont ajoutés.</p>
</dd>
<dt class="hdlist1">@Runtime( param )</dt>
<dd>
<p>Si <code>param</code> vaut :</p>
<div class="ulist">
<ul>
<li>
<p>"FreeMemory" : retourne la quantité de mémoire libre,</p>
</li>
<li>
<p>"TotalMemory" : retourne la quantité de mémoire alloue,</p>
</li>
<li>
<p>"MaxMemory" : retourne la quantité maximale de mémoire allouable.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"></dt>
<dd>
<p>Retourne la propriété de nom <code>param</code>.</p>
</dd>
<dt class="hdlist1">@SetValueInEnv( env , key1 , value1 , […​ , keyK , valueK ] [, returnValue] )</dt>
<dd>
<p>Affecte dans l’environnement <code>env</code> la clé <code>key1</code> (resp <code>keyK</code>) à la valeur <code>value1</code> (resp <code>valueK</code>), puis retourne le dernier paramètre ou <code>returnValue</code> ( si nombre pair de paramètres, impaire de couple clé,valeur).</p>
</dd>
<dt class="hdlist1">@StringToRegexp( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne de type expression régulière pour une utilisation dans une expression régulière.</p>
</dd>
<dt class="hdlist1">@SQLEncode( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne de type SQL pour utilisation dans une requête SQL.</p>
</dd>
<dt class="hdlist1">@SQLLikeEncode( expression )</dt>
<dd>
<p>Convertit la chaîne <code>expression</code> en une chaîne de type SQL-Like pour utilisation dans un "Like" d’une requête SQL.
@ToIterate(nbIteration=0 [,fieldName='nIterate'], [envName='@Iterator'])
Génère un environnement d’itération d’entier débutant à zéro jusqu’a nbIteration.
Le paramètre fieldName est le nom de champ d’affectation du numéro de l’itération ("nIterate" par défaut).
Le paramètre envName est le nom de l’environnement généré (par défaut "@Iterator").</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fonctions_de_fichiers_environnement_file"><span class="navy">Fonctions de fichiers (environnement @File)</span></h4>
<div class="paragraph">
<p>Ci-dessous le terme "fichier" désigne aussi bien un dossier qu’un document fichier.
Toutes les fonctions site sont accessibles par @File.@Nomfonction() ou directement par @Nomfonction() s’il n’y a pas d’ambiguïté avec un autre environnement.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@FileListRoot()</dt>
<dd>
<p>Liste les unités root du système.</p>
</dd>
<dt class="hdlist1">@File2String( file , charset [, offset ] [, nbChar ] )</dt>
<dd>
<p>Retourne le contenu du fichier file de jeu de caractères charset. Débute la lecture du fichier à l’offset offset (zéro par défaut) pour nbChar (-1 par défaut ou tous) caractères.</p>
</dd>
<dt class="hdlist1">@FileNbFile( dossier )</dt>
<dd>
<p>Retourne le nombre de fichiers du dossier dossier.</p>
</dd>
<dt class="hdlist1">@FileCanonicalPath( file )</dt>
<dd>
<p>Retourne le chemin canonique du fichier file.</p>
</dd>
<dt class="hdlist1">@FileAbsolutePath( file )</dt>
<dd>
<p>Retourne le chemin absolu du fichier file.</p>
</dd>
<dt class="hdlist1">@Filepath( file )</dt>
<dd>
<p>Retourne le chemin dossier du fichier file.</p>
</dd>
<dt class="hdlist1">@FileLastPath( folder , nbFolder )</dt>
<dd>
<p>Retourne les nbFolder dernier dossier du dossier folder.
Si nbFolder&lt;0, retourne le dossier (finissant par un /) complément au nb dernier dossier.</p>
</dd>
<dt class="hdlist1">@Filesize( file ) @Filesizekb( file ) @Filesizemb( file ) @Filesizegb( file )</dt>
<dd>
<p>Retourne la taille du fichier file en octet (resp : Kb, Mb, Gb)</p>
</dd>
<dt class="hdlist1">@FileLastmodified( file )</dt>
<dd>
<p>Retourne la date de dernière modification du fichier file.</p>
</dd>
<dt class="hdlist1">@FileExists( file )</dt>
<dd>
<p>Retourne vrai si le fichier file existe.</p>
</dd>
<dt class="hdlist1">@FileDirname( file )</dt>
<dd>
<p>Retourne le chemin du dossier du fichier file.</p>
</dd>
<dt class="hdlist1">@Filename( file ) , FileBasename( file )</dt>
<dd>
<p>Retourne le nom du fichier file (avec extension).</p>
</dd>
<dt class="hdlist1">@FileExtention( file ) FileExtension( file )</dt>
<dd>
<p>Retourne l’extension du fichier file.</p>
</dd>
<dt class="hdlist1">@FileRootname( file )</dt>
<dd>
<p>Retourne le radical du fichier file (dans "/root/toto.doc" c’est "toto"), sinon chaîne vide.</p>
</dd>
<dt class="hdlist1">@FileWithoutext @Filewithoutextention()</dt>
<dd>
<p>Retourne le chemin complet du fichier sans son extension.</p>
</dd>
<dt class="hdlist1">@FileIsfile( file )</dt>
<dd>
<p>Retourne vrai si le fichier est un document et nom un dossier.</p>
</dd>
<dt class="hdlist1">@FileIsDirectory( file )</dt>
<dd>
<p>Retourne vrai si le fichier est un dossier.</p>
</dd>
<dt class="hdlist1">@FileConcat( path1 [… ,​ pathK ] )()</dt>
<dd>
<p>Retourne la concaténation des chemins path1 à pathK en les séparent par un "/".</p>
</dd>
<dt class="hdlist1">@FileJava( file )</dt>
<dd>
<p>Convertit le chemin fichier système en un chemin fichier Posfix (Java).</p>
</dd>
<dt class="hdlist1">@FileSystem( file )</dt>
<dd>
<p>Convertit le chemin fichier en un chemin fichier système.</p>
</dd>
<dt class="hdlist1">@FileJavapath( path )</dt>
<dd>
<p>Ajoute un '/' a la fin de path, s’il n’existe pas.
Si path vaut nul, on retourne "/".</p>
</dd>
<dt class="hdlist1">@FileTmpPath()</dt>
<dd>
<p>Retourne un dossier temporaire.</p>
</dd>
<dt class="hdlist1">@FileGetTmpFile( onlyName )</dt>
<dd>
<p>Retourne un nom de fichier unique temporaire et le crée à vide.
Si onlyName est vrai, retourne uniquement le nom du fichier et pas son chemin complet.</p>
</dd>
<dt class="hdlist1">@FileGetTmpDir( onlyName )</dt>
<dd>
<p>Retourne un nom de dossier temporaire unique et le crée.
Si onlyName est vrai, retourne uniquement le nom du dossier et pas son chemin complet.</p>
</dd>
<dt class="hdlist1">@Filedir( dossier , regexp , mustMatch, fileType )</dt>
<dd>
<p>Liste les fichiers et dossiers du dossier dossier. Le paramètre regexp est une expression régulière permettant de filtrer les fichiers et dossiers retournés.
Le paramètre mustMatch indique que chaque nom de fichier doit correspondre à l’expression régulière.
Le paramètre fileType indique le type de fichier/dossier voulu :</p>
<div class="ulist">
<ul>
<li>
<p>0 : pour tous type de fichier (par défaut)</p>
</li>
<li>
<p>1 : pour que les fichiers</p>
</li>
<li>
<p>2 : pour que les dossiers
L’environnement retourné met à disposition pour chaque ligne retournée le nom du fichier au travers de la variable FileName et le nom du dossier au travers de DirName.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v3.0<br>
Last updated 2021-10-13 19:25:15 +0200
</div>
</div>
</body>
</html>