<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=ISO-8859-15" />
	<meta name="author" content="Multimédia SOLUTIONS" />
	<link rel="stylesheet" href="../../css/style.css" />
	<title>Le macro langage</title>
<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" type="text/javascript"><!--
jQuery(document).ready( function(){
	if (parent.frames.length!=0) { return; }
	jQuery('h1').eq(0).append('<div class="allHelp"><a href="../../index.htm">Toute la documentation</a></div>');
});
//-->
</script>
</head>
<body>
<h1 align="center">Le macro langage</h1>

<p>Les pages modèles utilisent un macro langage interprété par 
<span class="WindexServer">Windex Server</span> pour afficher des 
informations issues :</p>
<ul>
        <li>de la requête exprimée par l'utilisateur</li>
        <li>des informations dont dispose <span class="WindexServer">Windex Server</span> 
        sur les documents indexés<br>&nbsp;</li>
</ul>

<div class="attention">Les pages modèles sont basées sur du code HTML. Si 
	vous consultez ces pages avec un éditeur de texte ou HTML, vous 
	constaterez un affichage particulier. C'est normal. Ce macro langage 
	n'est interprété ni par votre navigateur ni par votre éditeur, 
	mais par&nbsp;<span class="WindexServer">Windex Server</span> 
	pour générer ensuite une page ne contenant 
	que du code HTML.<br> Si vous modifiez ces pages avec un éditeur 
	HTML, vérifiez bien que ce dernier ne modifie pas les instructions 
	du macro langage.</div>

<p>Comme tout langage, le macro langage de <span class="WindexServer">Windex Server</span> 
	a une syntaxe bien précise.</p>
<div  class="attention">Le macro langage de <span class="WindexServer">Windex Server</span> 
	fait la différence entre les majuscules et les minuscules.
</div>

<p>Les instructions qui doivent être interprétées par <span class="WindexServer">Windex Server</span> 
	sont comprises entre deux caractères dollars. Ce code est ensuite remplacé par 
	le résultat de son interprétation par <span class="WindexServer">Windex Server</span>.</p>
<p>Ce résultat peut être du texte à afficher, mais également du code HTML qui 
	sera traité par votre navigateur. Dans ce dernier cas, il faut bien penser à 
	ce qui va être généré pour que la syntaxe HTML soit respectée. Vous pouvez ainsi personnaliser l'affichage 
	d'une page en fonction de certaines conditions. </p>
<p>Plusieurs instructions peuvent être sur une même ligne.</p>

<div class="attention">Dans les chapitres qui suivent, une convention a 
	été adoptée lorsque certaines informations sont optionnelles. 
	Elles sont placées entre crochets.
</div>

<h2><a name="Syntaxe_des_fonctions">1. Syntaxe des fonctions</a></h2>
<p>Le nom d'une fonction est précédé d'une arobase. Une fonction exécute un 
traitement.<br></p>
<div class="cellule_exemple">@ma_fonction</div>
    
<p>Une fonction peut accepter des paramètres. Dans ce cas, ils sont indiqués 
après le nom de la fonction, entre parenthèse, séparés par une virgule.<br> 
</p>
<div class="cellule_exemple">@ma_fonction(param1, param2)<br>
	@ma_fonction(param1)</div>
	
<p>Si un paramètre est une constante, il est toujours encadré par des quotes 
	simples, que sa valeur <u>soit numérique ou non</u>. Si une chaîne de caractères 
	contient une quote, il faut la faire précéder d'un anti-slash.</p>
<div class="cellule_exemple">@ma_fonction('texte','2','3')</div>

<h2><a name="Syntaxe_des_variables">2. Syntaxe des variables</a></h2>
<p>Une variable représente une valeur numérique ou alphanumérique.</p>
<div class="cellule_exemple">ma_variable</div>

<h2><a name="Les_environnements">3. Les environnements</a></h2>
<p>Les fonctions et les variables sont regroupées dans des environnements en 
	dehors desquels elles ne sont pas reconnus. Il existe 3 environnements :</p>
<ul>
    <li>L'environnement par défaut :<br>Il regroupe l'ensemble des fonctions 
    et variables de base<br>Son nom est <span class="code">@</span>. </li>
    <li>L'environnement de la page appelante :<br>Il regroupe l'ensemble des 
    fonctions et variables permettant d'accéder aux formulaire de la page ayant 
    appelé la page courante.<br>Son nom est <span class="code">@Input</span>.</li>
    <li>L'environnement du résultat de recherche &nbsp;:<br>Il regroupe l'ensemble 
    des fonctions et variables permettant de manipuler le résultat de la recherche.<br>Son 
    nom est <span class="code">@WindexResult</span>.</li>
    <li>L'environnement de la recherche contextuelle :<br>Il regroupe l'ensemble 
    des fonctions et variables permettant de manipuler le résultat de la recherche 
    contextuelle.<br>Son nom est <span class="code">@WindexContext</span>.</li>
</ul>
<p>Pour préciser l'environnement à utiliser pour une fonction ou une variable, 
il suffit d'indiquer le nom de l'environnement suivi entre parenthèses de la 
fonction ou de la variable.</p>
<div class="code_exemple">@(ma_variable)<br>@Input(ma_variable)<br>@WindexResult(@ma_fonction(param1,param2))
  </div>

<h2><a name="Fonctions_speciales">4. Fonctions spéciales</a></h2>
<h3><a name="Begin">a) Instruction d'itération @Begin</a></h3>
<p>La syntaxe de cette fonction est :</p>
<p><span class="code">$@Begin( </span><span class="param">environnement</span><span class="code"> 
, </span><span class="param">debut</span><span class="code"> , </span><span class="param">max</span><span class="code"> 
)$<br><br>&lt;!-- <i>Début du code HTML à répéter --&gt;<br><br></i>&lt;!-- 
<i>Fin du code HTML à répéter --&gt;</i><br><br>$@End$</span></p>

<p>Cette fonction s'utilise dans un environnement contenant des informations 
sous forme de liste. Cette liste est parcourue à partir de l'enregistrement 
indiqué par <span class="param">debut</span> (<i>numérotation commençant à 0</i>) jusqu'à 
l'enregistrement <span class="param">debut</span> +<span class="param"> max</span>. 
ou à concurrence du dernier enregistrement.</p>
<p>Le code compris entre <span class="code">$@Begin(...)$</span> et <span class="code">$@End$</span> 
est répété pour chaque enregistrement dans la page HTML retournée. A noter également 
que <span class="param">environnement</span> est considéré comme l'environnement 
par défaut : il n'est donc pas nécessaire de le préciser lorsqu'on utilise des 
fonctions ou variables de cet environnement, sauf pour lever une ambiguïté.</p>
<p>Exemple :</p>
<p>Soit l'environnement <span class="code">@mon_environnement</span>, contenant 20 enregistrements.</p>
<div class="code_exemple">$@Begin( @mon_environnement, 5 , 10)$<br>
	Il pleut,&lt;br&gt;<br>
	$@End$
</div>
	 
<p>La portion de la page HTML retournée correspondant à ce code sera :</p>
<div class="code_exemple">Il pleut,&lt;br&gt;<br>Il 
            pleut,&lt;br&gt;<br>Il pleut,&lt;br&gt;<br>Il pleut,&lt;br&gt;<br>Il 
            pleut,&lt;br&gt;<br>Il pleut,&lt;br&gt;&nbsp;</div>
			
<p>Cette fonction sera utilisée dans la page d'affichage des réponses pour parcourir 
l'ensemble des réponses et les mettre en forme.</p>
<h3><a name="BeginIf">b) Instruction conditionnelle @BeginIf</a></h3>
<p>La syntaxe de cette fonction est :</p>
<p><span class="code">$@BeginIf( <span class="param">environnement , expression0</span>)$</span><br>
	<br>&lt;!--<i>Code HTML à afficher --&gt;</i><br>
	<br>
	<span class="code">$@ElseIf(<span class="param">expressionK</span>)$</span><br>
	<br> &lt;!--<i>Code HTML à afficher --&gt;</i><br>
	<br>
	<span class="code">$@Else$</span><br>
	<br> &lt;!--<i>Code HTML à afficher par défaut --&gt;</i> <br>
	<br>
	<span class="code">$@End$</span></p>
<p>Si <span class="param">expression0</span> est vrai dans l'environnement <span class="param">environnement</span>, 
le code compris entre <span class="code">$@BeginIf(...)$</span> et le premier <span class="code">$@ElseIf$</span> 
ou <span class="code">$@Else$</span> ou <span class="code">$@End$</span> 
est recopié dans la page retournée.
Sinon c'est le prochain code html se trouvant apres un <span class="code">@ElseIf</span> vrai,
	 sinon en dernier resort celui se trouvant après un <span class="code">@Else</span><br>
	Bien entendu vous pouvez mettre autant de <span class="code">@ElseIf</span> que voulut, 
	et un seule <span class="code">$@Else$</span>
<br>
 A noter également que <span class="param">environnement</span> 
est considéré comme l'environnement par défaut : il n'est donc pas nécessaire 
de le préciser lorsqu'on utilise des fonctions ou variables de cet environnement, 
sauf pour lever une ambiguïté.</p>
<h2><a name="environnement_@">5. L'environnement @</a></h2>
<p>Il rassemble toutes les fonctions basiques  :</p>
<ul>
    <li>opérations conditionnelles</li>
    <li>opérations logiques</li>
    <li>comparaisons</li>
    <li>manipulations de chaînes de caractères</li>
    <li>manipulations de nombres et de dates</li>
    <li>manipulation d'URL</li>
</ul>
<h3><a name="Tests">a) Opérations conditionnelles</a></h3>
<h4><span class="code"><a name="true">@true</a></span></h4>
<ul>
    <p>Correspond à la valeur booléenne <i>vrai.</i></p>
</ul>
<h4><span class="code"><a name="false">@false</a></span></h4>
<ul>
    <p>Correspond à la valeur booléenne <i>faux.</i>&nbsp;</p>
</ul>
<h4><span class="code"><a name="if">@If</a>( 
</span><span class="param">condition1</span> <span class="code">,</span> <span class="param">expression1</span> 
<span class="param">[, condition2, expression2 ... ,conditionN</span><span class="code">, 
</span><span class="param">expressionN ]</span><span class="code">, </span><span class="param">defaut</span> 
<span class="code">)&nbsp;</span></h4>
<ul>
    <p>Si <span class="param">condition1</span> est vrai, <span class="param">expression1</span> 
    est évaluée. Sinon, si <span class="param">condition2</span> est vrai, <span class="param">expression2</span> 
    est évaluée et ainsi de suite. Si aucune condition n'est vrai, <span class="param">defaut</span> 
    est évaluée.</p>
</ul>
<h4><span class="code"><a name="if">@</a>IsEmpty( 
</span><span class="param">expression1</span> 
 
<span class="code">)&nbsp;</span></h4>
<ul>
    <p>Retourne la valeur <b>VRAI</b> si l'expression <span class="param">expression1 </span>est une chaîne vide ou une valeur <b>Null.</b></p>
</ul>
<h4><span class="code"><a name="if">@</a>IsNotEmpty( 
</span><span class="param">expression1</span> 
 
<span class="code">)&nbsp;</span></h4>
<ul>
    <p>Retourne la valeur <b>FAUX</b> si l'expression <span class="param">expression1 </span>est une chaîne vide ou une valeur <b>Null.</b></p>
</ul>

<h4><span class="code"><a name="if">@</a>IfEmpty( </span><span class="param">expression1, defaultValue</span> <span class="code">)&nbsp;</span></h4>
<ul>
    <p>Retourne la valeur <b>defaultValue</b> si l'expression <span class="param">expression1 </span>est une chaîne vide ou une valeur <b>Null.</b><br>
    Sinon retourne <span class="param">expression1 </span>  </p>
</ul>

<h3><a name="Operateurs_logiques">b) Opérateurs logiques</a></h3>
<h4><span class="code"><a name="Not">@Not</a>( </span><span class="param">expression</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression</span> doit être de type booléenne.<br>Si <span class="param">expression</span> est vrai, retourne faux. Si 
    <span class="param">expression</span> est faux, retourne vrai.</p>
</ul>
<h4><span class="code"><a name="And">@And</a>( </span><span class="param">expression1</span><span class="code"> 
, </span><span class="param">expression2</span><span class="code"> )</span></h4>
<ul>
    <p><span class="param">expression1 </span>et <span class="param">expression2</span>&nbsp;doivent 
    être de type booléenne.<br>Effectue un &quot;et&quot; logique entre les 
    deux expressions. Si <span class="param">expression1</span> et <span class="param">expression2</span> 
    sont vrais, alors vrai est retourné. Dans tous les autres cas, faux est 
    retourné.</p>
</ul>
<h4><span class="code"><a name="Or">@Or</a>( </span><span class="param">expression1</span><span class="code"> 
, </span><span class="param">expression2</span><span class="code"> )</span></h4>
<ul>
    <p><span class="param">expression1 </span>et <span class="param">expression2</span>&nbsp;doivent 
    être de type booléenne.<br>Effectue un &quot;ou&quot; logique entre les 
    deux expressions. Si <span class="param">expression1</span> et <span class="param">expression2</span> 
    sont faux, alors faux est retourné. Dans tous les autres cas, vrai est retourné.</p>
</ul>
<h3><a name="Comparaisons">c) Comparaisons</a></h3>
<h4><span class="code"><a name="Superior">@Superior</a>( </span><span class="param">expression1</span> 
<span class="code">,</span> <span class="param">expression2</span> <span class="code">)</span></h4>
<ul>
    <p>Compare les deux expressions lexicographiquement. Si <span class="param">expression1</span> 
    est supérieure à <span class="param">expression2</span>, alors vrai est 
    retournée, sinon faux.</p>
</ul>
<h4><span class="code"><a name="Inferior">@Inferior</a>( </span><span class="param">expression1</span> 
<span class="code">,</span> <span class="param">expression2</span> <span class="code">)</span></h4>
<ul>
    <p>Compare les deux expressions lexicographiquement. Si <span class="param">expression1</span> 
    est inférieure à <span class="param">expression2</span>, alors vrai&nbsp;est 
    retournée, sinon faux.</p>
</ul>
<h4><span class="code"><a name="Cmp">@Cmp</a>( </span><span class="param">expression1</span><span class="code"> 
, </span><span class="param">expression2</span><span class="code"> )</span></h4>
<ul>
<p>Si <span class="param">expression1</span> est égale à <span class="param">expression2</span>, 
    retourne vrai, sinon faux.</p>
</ul>
<h4><span class="code"><a name="Min">@Min</a>( </span><span class="param">expression1</span><span class="code"> 
, </span><span class="param">expression2</span><span class="code"> )<a name="upd_031120_a"></a></span></h4>
<ul>
    <p><span class="param">expression1</span> et <span class="param">expression2</span> 
    doivent être des expressions de type numérique.<br>Retourne l'expression 
    la plus petite des deux.</p>
</ul>
<h4><span class="code"><a name="Max">@Max</a>( </span><span class="param">expression1</span><span class="code"> 
, </span><span class="param">expression2</span><span class="code"> )<a name="upd_031120_b"></a></span></h4>
<ul>
    <p><span class="param">expression1</span> et <span class="param">expression2</span> 
    doivent être des expressions de type numérique.<br>Retourne l'expression 
    la plus grande&nbsp;des deux.</p>
</ul>
<h3><a name="Manipulations_chaines">d) Manipulations de chaînes de caractères</a></h3>
<h4><span class="code"><a name="Length">@Length</a>( </span><span class="param">expression</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Cette fonction retourne alors la longueur de ce texte.</p>
</ul>
<h4><span class="code"><a name="Mid">@Mid</a>( </span><span class="param">expression</span><span class="code"> 
, </span><span class="param">debut</span><span class="code"> [, </span><span class="param">fin 
]</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">debut </span>et<span class="param"> fin </span>doivent 
    être des expressions de type numérique.<br><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Cette fonction retourne la portion 
    de <span class="param">expression</span> depuis le caractère indiqué par <span class="param">debut</span> 
    (l<i>a numérotation commence à 0</i>) jusqu'au caractère indiqué par <span class="param">fin 
    </span>(<i>exclus</i>). Si <span class="param">fin</span> est omis, la portion 
    de texte commence à <span class="param">debut</span> jusqu'à la fin de la 
    chaîne.</p>
</ul>
<h4><span class="code"><a name="Left">@Left</a>( </span><span class="param">expression</span><span class="code"> 
, </span><span class="param">nbCaracteres</span><span class="code"> )</span></h4>
<ul>
    <p><span class="param">nbCaracteres </span>doit être une expression de type 
    numérique.<br><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Retourne les <span class="param">nbCaracteres</span> caractère 
    du texte à partir de sa gauche.</p>
</ul>
<h4><span class="code"><a name="Right">@Right</a>( </span><span class="param">expression</span><span class="code"> 
, </span><span class="param">nbCaracteres</span><span class="code">&nbsp;)</span></h4>
<ul>
    <p><span class="param">nbCaracteres </span>doit être une expression de type 
    numérique.<br><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Retourne les <span class="param">nbCaracteres</span> caractère 
    du texte à partir de sa droite.&nbsp;</p>
</ul>
<h4><span class="code"><a name="Replace">@Replace</a>( </span><span class="param">expression1,</span><span class="code"> 
</span><span class="param">expression2</span><span class="code"> , </span><span class="param">expression3</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression1</span>, <span class="param">expression2</span>&nbsp;et <span class="param">expression3</span>&nbsp;doivent retourner une chaîne de caractères. 
    <br>Remplace <span class="param">expression2</span> par <span class="param">expression3</span> 
    dans <span class="param">expression1</span>.</p>
</ul>

<h4><span class="code"><a name="Replace">@ReplaceRegEx</a>( </span><span class="param">expression1,</span><span class="code"> 
</span><span class="param">expression2</span><span class="code"> , </span><span class="param">expression3</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression1</span>, <span class="param">expression2</span>&nbsp;et <span class="param">expression3</span>&nbsp;doivent retourner une chaîne de caractères. 
    <br>Dans  <span class="param">expression1</span> remplace toutes les extraction de l'expression regulière donné par <span class="param">expression2</span> par <span class="param">expression3</span>.<br/>
    Vous pourez trouver des informations sur les expressions règulière sur http://download.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html 
    ou http://www.loribel.com/info/memento/regex.html
    </p>
</ul>


<h4><span class="code"><a name="Concat">@Concat</a>( </span><span class="param">expression1</span><span class="code"> 
</span><span class="param">[ , expressionN ...]</span><span class="code"> )</span></h4>
<ul>
    <p>Concatène les différentes expressions (<i>toutes doivent retourner une chaîne de caractères</i>).</p>
</ul>
<h4><span class="code"><a name="HtmlEncode">@HtmlEncode</a>( </span><span class="param">expression</span><span class="code"> 
, [ </span><span class="param">separateur</span><span class="code"> ] )</span></h4>
<ul>
    <p><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Encode <span class="param">expression</span>. <br>En HTML, certains caractères 
    sont traduits par une séquence d'un ou plusieurs caractères afin qu'ils 
    n'entrent pas en conflit avec la syntaxe même du langage. Ainsi, si vous 
    voulez afficher le caractère &quot;<span class="code">&gt;</span>&quot;, 
    vous devrez écrire en HTML <span class="code">&amp;gt;</span> ou bien <span class="code">&amp;#62;</span></p>
    <p>La fonction <span class="code">@HtmlEncode</span> effectue cette conversion 
    sur le contenu de l'expression qu'elle retourne.</p>
    <p>Elle est très utile lorsque vous affichez le contenu d'une variable dans 
    la page HTML et que vous ne contrôlez pas forcément le contenu de cette 
    variable.</p>
    <p>Si <span class="param">expression</span> contient le caractère de saut 
    de ligne (&quot;<span class="code">\n</span>&quot;), il peut être remplacé 
    par la valeur de <span class="param">separateur</span>. Ainsi, dans un document 
    HTML, le saut à la ligne n'étant pas interprété, on peut par exemple le 
    remplacer par la balise <span class="code">&lt;br&gt;</span>.</p>
</ul>
<h4><span class="code"><a name="HtmlDecode">@HtmlDecode</a>( </span><span class="param">expression</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Décode <span class="param">expression</span>. Cette fonction est l'opposée 
    de <span class="code"><a href="#HtmlEncode">@HtmlEncode</a></span><a href="#HtmlEncode">.</a></p>
</ul>
<h4><span class="code">@<a name="IsInList">IsInList</a>( </span><span class="param">expression</span><span class="code"> 
,&nbsp;</span><span class="param">liste</span><span class="code"> [ , </span><span class="param">separateurs</span><span class="code"> 
] )<a name="upd_031120_c"></a></span></h4>
<ul>
    <p><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Retourne vrai si <span class="param">expression</span> est présente dans 
    <span class="param">liste</span>, <span class="param">liste</span> étant 
    une suite de chaînes de caractères, séparées par un caractère (<i>par défaut 
    la virgule ou le point-virgule</i>).<br><span class="param">separateurs</span> 
    contient le ou les séparateurs de chaînes.</p>
    <ul>
        <p>Exemple :<br><span class="code">@IsInList( &quot;doc&quot; , &quot;doc;html;htm;txt&quot; 
        )</span> retourne vrai car <span class="code">doc</span> est bien dans 
        la liste.</p>
    </ul>
</ul>
<h4><span class="code">@<a name="SelectInList">SelectInList</a>( </span><span class="param">expression</span><span class="code"> 
, </span><span class="param">liste</span><span class="code"> , </span><span class="param">defaut</span><span class="code">&nbsp;, 
[ </span><span class="param">separateur</span><span class="code"> ] )<a name="upd_031120_d"></a></span></h4>
<ul>
<p><span class="param">liste</span> est une suite de chaînes de caractères, 
séparées par un caractère (p<i>ar défaut, la virgule ou le point-virgule</i>). 
D'autres séparateurs peuvent être indiqués via le paramètre <span class="param">separateur</span>.</p>
<p><span class="param">expression</span> est retournée si elle existe dans <span class="param">liste</span>, 
sinon c'est <span class="param">defaut</span> qui est renvoyé. </p>
</ul>
<h4><span class="code"><a name="Contain">@Filter(</a> </span><span class="param">val</span><span class="code"> 
, </span><span class="param">regexp</span><span class="code"> )<a name="upd_031120_d"></a></span></h4>
<ul>
<p>Si <b>va</b>l contient la forme exprimée par l'expression regulière <b>'regexp',</b> elle est retournée.<br>Si<b> val </b>est un tableau, alors retourne un tableau contenant chaque valeur du tableau initial dont les chaînes contiennent la forme exprimée par l'expression regulière&nbsp;<b>'regexp'</b> .</p>
</ul>
<h4><span class="code">@</span>Contain<span class="code">( </span><span class="param">val</span><span class="code"> 
, </span><span class="param">arg1</span><span class="code"> [, ..., </span><span class="param">argK</span><span class="code"> ] )<a name="upd_031120_d"></a></span></h4>
<ul>
<p>Retourne la première valeur <b>arg1</b> à <b>argK</b> qui contient la valeur <b>val.</b></p>
</ul>
<h4><span class="code"><a name="Transpose">@Transpose( </a></span><span class="param"><a name="Transpose">expression1</a></span><span class="code"><a name="Transpose"> , </a></span><span class="param"><a name="Transpose">expression2</a></span><span class="code"><a name="Transpose"> [, </a></span><span class="param"><a name="Transpose">expression3</a></span><span class="code"><a name="Transpose"> ])</a><a name="upd_040116_a"></a></span></h4>
<ul>
    <p><span class="param">expression1</span> doit retourner une chaîne de caractères, tout comme <span class="param">expression2</span> et <span class="param">expression3</span>.</p>
    <p>Pour chaque caractère de <span class="param">expression2</span> est remplacé par le caractère correspondant de <span class="param">expression3</span> dans <span class="param">expression1</span>. S'il n'y a pas de correspondance, le caractère est supprimé. </p>
    <p>Si <span class="param">expression3</span> n'est pas renseigné, tous les caractères de <span class="param">expression2</span> trouvés dans <span class="param">expression1</span> sont supprimés.</p>
    <p>S'il y a plus de caractères dans <span class="param">expression3</span> que dans <span class="param">expression2</span>, les caractères de <span class="param">expression3</span> situés au delà de la longueur de <span class="param">expression2</span> sont ignorés.</p>
    <p>la fonction est sensible à la casse.</p>
</ul>
<ul>
    <p>Exemples :<br></p>
</ul>
                        <table class="tableau">
							<thead>
                            <tr>
                                <th>Expression</th>
                                <th>Résultat</th>
                            </tr>
							</thead>
							<tbody>
                            <tr>
                                <td>
                                    <p class="code">@Transpose( &quot;abcdef&quot;, &quot;b&quot; , &quot;Z&quot;)</p>
                                </td>
                                <td>
                                    <p class="code">aZcdef</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">@Transpose( &quot;abcdef&quot;, &quot;bdf&quot; , &quot;ZZZ&quot;)</p>
                                </td>
                                <td>
                                    <p class="code">aZcZeZ</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">@Transpose( &quot;abcdef&quot;, &quot;bdf&quot; )</p>
                                </td>
                                <td>
                                    <p class="code">ace</p>
                                </td>
                            </tr>
							<tr>
                                <td height="17">
                                    <p class="code">@Transpose( &quot;abcdef&quot;, &quot;bdf&quot; , &quot;ZZ&quot;)</p>
                                </td>
                                <td height="17">
                                    <p class="code">aZcZe</p>
                                </td>
							</tr>
							</tbody>
                        </table>
<h4><span class="code"><a name="Implode">@Implode( </a></span><span class="param"><a name="Implode">tableau, separator, [nbElement]</a></span><span class="code"><a name="Implode"> )</a><a name="upd_040116_b"></a></span></h4>
<ul>
    <p>Retourne la concaténation du tableau de valeur <b>'tableau'</b> en utilisant comme séparateur la chaîne <b>'separator'</b> .<br>Si <b>nbElement</b> est supérieur à zéro cette fonction ne concaténe que les <b>'nbElement'</b> premier valeur du tableau 'tableau'. <br>si <b>nbElement</b> est négatif, la concaténation ne s'effectue que sur les <b>'nbElement'</b> dernière valeur du tableau 'tableau'. </p>
</ul>
<h4><span class="code"><a name="Split">@Split( </a></span><span class="param"><a name="Split">val, regexp [, nb]</a></span><span class="code"><a name="Split"> )</a><a name="upd_040116_b"></a></span></h4>
<ul>
    <p>Retourne le tableau résultant du découpage de la chaîne <b>val</b> en utilisant l'expression régulière <b>regexp</b> comme séparateur.<br>Exemple : @Split(&quot;toto,titi;tutu&quot;,&quot;[,;]&quot;) retourne le tableau composé des 3 chaînes &quot;toto&quot;, &quot;titi&quot;, &quot;tutu&quot; .<br>Le nombre <b>nb</b> indique la taille du tableau à retourner &nbsp;Exemple : @Split(&quot;toto,titi;tutu&quot;,&quot;[,;]&quot;, '1') retourne le tableau composé des 2 chaînes &quot;toto&quot;, &quot;titi;tutu&quot; <br>En combinaison avec <a href="#Implode">@Implode()</a> on peut éliminer certaine partie d'une chaîne.<br> Par exemple : <br>&nbsp;&nbsp;&nbsp;&nbsp;@Implode(@Split(&quot;<i>Info:mon info;ceci est le résumé qui utilise aussi un le ';' dans sont texte </i>!&quot;, &quot;;&quot;, 2) , &quot; &quot;, -1)<br> retourne que <br>&nbsp;&nbsp;&nbsp;&nbsp;&quot;<i>ceci est le résumé qui utilise aussi un le ';' dans sont texte !</i>&quot;</p>
</ul>
<h4><span class="code"><a name="ToLowercase">@ToLowerase( </a></span><span class="param"><a name="ToLowercase">expression</a></span><span class="code"><a name="ToLowercase"> )</a><a name="upd_040116_c"></a></span></h4>
<ul>
    <p><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Retourne l'équivalent de expression en caractères minuscules.</p>
</ul>
<h4><span class="code"><a name="ToUppercase">@ToUppercase( </a></span><span class="param"><a name="ToUppercase">expression</a></span><span class="code"><a name="ToUppercase"> )</a><a name="upd_040116_c"></a></span></h4>
<ul>
    <p><span class="param">expression</span> doit retourner une chaîne de caractères. 
    <br>Retourne l'équivalent de expression en caractères majuscules.</p>
</ul>
<h3><a name="Manipulations_nombres">e) Manipulations de nombres et de dates</a></h3>
<h4><span class="code">@<a name="Date">Date</a> <a name="upd_031120_e"></a></span></h4>
<ul>
    <p>Retourne la date actuelle. La date peut être formatée par la fonction 
    <span class="code"><a href="mailto:@FormatDate.">@FormatDate</a></span><a href="mailto:@FormatDate.">.</a></p>
</ul>
<h4><span class="code">@<a name="Date">Date</a><a name="upd_031120_e"></a>( </span><span class="param">temps_en_ms</span><span class="code"> 
)</span></h4>
<ul>
    <p>Retourne la date <span class="param">temps_en_ms </span>exprimée en millisecondes depuis le 1er Janvier 1970.</p>
</ul>
<h4><span class="code">@<a name="Date">Date</a>( </span><span class="param">année, mois, jour</span><span class="code"> 
)</span></h4>
<ul>
    <p>Retourne la date correspondant à <b>jour</b>/<b>mois</b>/<b>année</b>.</p>
</ul>
<h4><span class="code">@<a name="Date">Date</a><a name="upd_031120_e"></a><a name="upd_031120_e"></a>( </span><span class="param">année, mois, jour, heure, minute, seconde</span><span class="code"> 
)</span></h4>
<ul>
    <p>Retourne la date correspondant à<b> jour</b>/<b>mois</b>/<b>année</b> <b>heur</b>e:<b>minute</b>:<b>seconde</b>.</p>
</ul>
<h4><span class="code">@<a name="Date">Date</a>add( </span><span class="param">date, année,&nbsp;mois, jour, heure, minute, seconde</span><span class="code"> 
)</span></h4>
<ul>
    <p>Retourne la date résultat de l'addition à la date '<b>date</b>' et le temps donnée pas les valeurs positives ou &nbsp;négatives <b>année</b>,<b>mois</b>,<b>jour</b>,<b>heure</b>,<b>minute</b>,<b>seconde</b>, <b>milliseconde</b>.</p>
</ul>
<h4><span class="code">@<a name="Date">Date</a>Field<a name="upd_031120_e"></a><a name="upd_031120_e"></a><a name="upd_031120_e"></a>(</span><span class="param">type,&nbsp;date</span><span class="code"> 
)</span></h4>
<ul>
    <p>La valeur &quot;<b>date&quot;</b> doit être une date.<br>Suivant la valeur de &quot;<b>type&quot;</b> parmi les chaînes suivantes :</p>
    <ul>
        <li>&quot;YEAR&quot; &nbsp;: retourne l'année </li>
        <li>&nbsp;&quot;MONTH&quot; &nbsp;: retourne le : 1 à 12 </li>
        <li>&nbsp;&quot;DATE&quot; &nbsp;: retourne le jour de la date 1 à 31 </li>
        <li>&nbsp;&quot;HOUR&quot; : retourne l'heure basée sur 24 </li>
        <li>&nbsp;&quot;MINUTE&quot; &nbsp;: retourne les minutes </li>
        <li>&nbsp;&quot;SECOND&quot; : retourne les secondes </li>
        <li>&nbsp;&quot;MILLISECOND&quot; : retourne les millisecondes </li>
        <li>&nbsp;&quot;WEEK_OF_MONTH&quot; : retourne la semaine du mois </li>
        <li>&nbsp;&quot;DAY_OF_YEAR&quot; : retourne le jour de l'année </li>
        <li>&nbsp;&quot;WEEK_OF_YEAR&quot; : retourne la semaine de l'année </li>
        <li>&nbsp;&quot;DAY_OF_WEEK&quot; : retourne le jour de la semaine basé sur Dimanche pour 1er jour </li>
        <li>&nbsp;&quot;DAY_OF_WEEK_IN_MONTH&quot; : retourne &nbsp;1 pour 1er mardi du mois, 2 pour 2ième , ... </li>
    </ul>
    <p>Sinon retourne FAUX.</p>
</ul>
<h4><span class="code"><a name="Inc">@Inc</a>( </span><span class="param">expression</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression </span>doit être une expression de type 
    numérique.<br>Retourne la valeur de <span class="param">expression</span> 
    incrémentée de 1.</p>
</ul>
<h4><span class="code"><a name="Dec">@Dec</a>( </span><span class="param">expression</span><span class="code"> 
)</span></h4>
<ul>
    <p><span class="param">expression </span>doit être une expression de type 
    numérique.<br>Retourne la valeur de <span class="param">expression</span> 
    décrémentée&nbsp;de 1.</p>
</ul>
<h4><span class="code"><a name="Dec">@</a>Sum( </span><span class="param">val1, ...,&nbsp;valK</span><span class="code"> 
)</span></h4>
<ul>
    <p>Retourne la somme des valeurs données <b>val1</b> à <b>valK</b>. <br>Si une des valeurs est une chaîne, elle est convertie en nombre avant de faire la somme. <br>Si la convertion est impossible, elle est ignorée.&nbsp;<br></p>
</ul>
<h4><span class="code"><a name="Dec">@D</a>ivide( </span><span class="param">nombre1, nombre2</span><span class="code"> 
)</span></h4>
<ul>
    <p>Retourne le résultat de la division du nombre &nbsp;'nombre1' par le nombre 'nombre2' <br></p>
</ul>
<h4><span class="code"><a name="Dec">@</a>ToDouble( </span><span class="param">val</span><span class="code"> 
)</span></h4>
<ul>
    <p>Convertie la valeur '<b>val</b>' en un nombre réel à double précision.</p>
</ul>
<h4><span class="code"><a name="Dec">@</a>ToFloat( </span><span class="param">val</span><span class="code"> 
)</span></h4>
<ul>
    <p>Convertie la valeur '<b>val</b>' en un nombre réel simple&nbsp;précision.</p>
</ul>
<h4><span class="code"><a name="Dec">@</a>ToInteger( </span><span class="param">val</span><span class="code"> 
)</span></h4>
<ul>
    <p>Convertie la valeur '<b>val</b>' en un entier..</p>
</ul>
<h4><span class="code"><a name="FormatNumber">@FormatNumber</a></span>( 
<span class="param">expression</span> 
,  <span class="param">formatSortie</span> [
, <span class="param">localisationSortie</span> &nbsp;[ , <span class="param">localisationEntrée</span> 
]&nbsp;]&nbsp;)</h4>
<ul>
    <p>Cette fonction permet de formater une expression de type numérique.</p>
</ul>
<table class="tableau">
<thead>
	<tr>
		<th>Symbole</th>
		<th>Signification</th>
	</tr>
</thead>
<tbody>
	<TR>
	<TD align="center">
				<p class="code">0</td>

	<TD><span class="texte">Chiffre</span></td>
	 
	<TR>
	<TD align="center">
					<p class="code">#</td>

	<TD><span class="texte">Chiffre, les zéros non significatifs ne sont pas affichés</span></TD>
	<TR>
	<TD align="center">
						<p class="code">.</td>

	<TD><span class="texte">Séparateur décimal ou séparateur monétaire.</span></TD>
	<TR>
	<TD align="center">
							<p class="code">-</td>

	<TD><span class="texte">Signe moins</span></TD>
	<TR>
	<TD align="center">
								<p class="code">,</td>

	<TD><span class="texte">Séparateur de milliers.</span></TD>
	<TR>
	<TD align="center">
									<p class="code">%</td>

	<TD><span class="texte">Multiplie la valeur par 100 et l'affichage comme pourcentage</span></TD>
	<TR>
	<TD align="center">
										<p class="code">'</td>

	<TD><span class="texte">Utilisé pour annuler la fonction d'un caractère spécial. <br>Par exemple 
	&quot;</span>'<span class="code">'#'#</span><span class="texte">&quot; formate 
	le nombre </span><span class="code">123</span> <span class="texte">en &quot;</span><span class="code">#123</span><span class="texte">&quot;. <br>Pour 
	afficher une quote simple, doublez la quote.</span></TD></TR>
	<tbody>
</table>
                        <ul>
                        <p>&nbsp;Exemples :</p>
                        </ul>
                        <table class="tableau">
							<thead>
                            <tr>
                                <th>Expression</th>
                                <th>Format de sortie</th>
                                <th>Résultat</th>
                            </tr>
						</thead>
						<tbody>
                            <tr>
                                <td>
                                    <p class="code">123.10</p>
                                </td>
                                <td>
                                    <p class="code">#.#</p>
                                </td>
                                <td>
                                    <p class="code">123.1</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">123.10</p>
                                </td>
                                <td>
                                    <p class="code">#.00</p>
                                </td>
                                <td>
                                    <p class="code">123.10</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">123456789</p>
                                </td>
                                <td>
                                    <p class="code">#,###,###</p>
                                </td>
                                <td>
                                    <p class="code">123.456.789</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">0.12</p>
                                </td>
                                <td>
                                    <p class="code">#%</p>
                                </td>
                                <td>
                                    <p class="code">12%</p>
                                </td>
                            </tr>
						</tboby>
                        </table>
                        <ul>
                            <p>Il est possible de prendre en compte les caractéristiques 
                            locales à un pays et/ou une langue en renseignant 
                            les paramètres <span class="param">localisationEntrée</span> 
                            et<span class="param"> localisationSortie</span>. 
                            Leurs valeurs peuvent influencer le séparateur décimal 
                            ou de milliers par exemple. Les deux paramètres 
                            ont la même syntaxe :</p>
                            <p align="center"><span class="code">langue/PAYS</span></p>
                        </ul>
                        <ul>
                            <p><span class="param">localisationEntrée</span> 
                            indique les règles du pays et/ou de la langue dans 
                            lesquelles la valeur numérique est exprimée.</p>
                        </ul>
                        <ul>
                            <p><span class="param">localisationSortie</span> 
                            indique les règles du pays et/ou de la langue&nbsp;dans 
                            lesquelles la valeur numérique sera formattée.</p>
                            <p>Nous n'indiquerons pas ici la liste de toutes 
                            les langues et pays (<i>plusieurs centaines de lignes</i>). 
                            Sachez que pour le format français, le code est 
                            <span class="code">fr/FR</span> et que pour le format 
                            anglais, le code est <span class="code">en/EN</span>.</p>
                            <p>Exemple :</p>
                        </ul>
                        <table class="tableau">
						<thead>
                            <tr>
                                <th>Expression</th>
                                <th>Format de sortie</th>
                                <th>Localisation<br>Entrée</th>
                                <th>Localisation<br>Sortie</th>
                                <th>Résultat</th>
                            </tr>
						</thead>
						</tbody>
                            <tr>
                                <td>
                                    <p class="code">123.10</p>
                                </td>
                                <td>
                                    <p class="code">#.#</p>
                                </td>
                                <td>
                                    <p>en/EN</p>
                                </td>
                                <td>
                                    <p>fr/FR</p>
                                </td>
                                <td>
                                    <p class="code">123,1</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">123.10</p>
                                </td>
                                <td>
                                    <p class="code">#.#</p>
                                </td>
                                <td>
                                    <p>en/EN</p>
                                </td>
                                <td>
                                    <p>en/EN</p>
                                </td>
                                <td>
                                    <p class="code">123.1</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">123456789</p>
                                </td>
                                <td>
                                    <p class="code">#,###,###</p>
                                </td>
                                <td>
                                    <p>en/EN</p>
                                </td>
                                <td>
                                    <p>fr/FR</p>
                                </td>
                                <td>
                                    <p class="code">123 456 789</p>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="code">123456789</p>
                                </td>
                                <td>
                                    <p class="code">#,###,###</p>
                                </td>
                                <td>
                                    <p>en/EN</p>
                                </td>
                                <td>
                                    <p>en/EN</p>
                                </td>
                                <td>
                                    <p class="code">123,456,789</p>
                                </td>
                            </tr>
                        </table>
<h4><span class="code"><a name="FormatDate">@FormatDate</a></span>( 
<span class="param">expression</span> 
, <span class="param">formatEntrée</span> 
, <span class="param">formatSortie</span> 
)</h4>
<ul>
    <p>Cette fonction permet de formater une expression de type date. La date 
                            courante peut être obtenue grâce à la fonction <span class="code"><a href="macro.htm#Date">@Date</a></span>.</p>
</ul>
<table class="tableau">
<thead>
<tr>
	<th>Symbole</th>
	<th>Signification</th>
	<th>Type</th>
	<th>Exemple</th>
</tr>
</thead>
<tbody>
	<tr><td align="center">
										<p class="code">G</td><td><span class="texte">Ere</span></td><td align="center"><span class="texte">Texte</span></td><td>
										<p class="code">JC</td></tr>
	<tr><td align="center">
										<p class="code">y</td><td><span class="texte">Année</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">1996</td></tr>
	<tr><td align="center">
										<p class="code">M</td><td><span class="texte">Mois dans l'année</span></td><td align="center"><span class="texte">Texte 
										et nombre</span></td><td>
										<p><span class="code">Juillet</span> et <span class="code">07</span></td></tr>
	<tr><td align="center">
										<p class="code">d</td><td><span class="texte">Jour dans le mois</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">10</td></tr>
	<tr><td align="center">
										<p class="code">h</td><td><span class="texte">Heure (<i>de 1 à 
										12</i>)</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">12</td></tr>
	<tr><td align="center">
										<p class="code">H</td><td><span class="texte">Heure (<i>de 0 à 
										23</i>)</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">0</td></tr>
	<tr><td align="center">
										<p class="code">k</td><td><span class="texte">Heure (<i>de 1 à 
										24</i>)</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">24</td></tr>
	<tr><td align="center">
										<p class="code">K</td><td><span class="texte">Heure (<i>de 0 
										à 11</i>)</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">0</td></tr>
	<tr><td align="center">
										<p class="code">m</td><td><span class="texte">Minute</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">30</td></tr>
	<tr><td align="center">
										<p class="code">s</td><td><span class="texte">Seconde</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">55</td></tr>
	<tr><td align="center">
										<p class="code">S</td><td><span class="texte">Milliseconde</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">978</td></tr>
	<tr><td align="center">
										<p class="code">E</td><td><span class="texte">Jour de la semaine</span></td><td align="center"><span class="texte">Texte</span></td><td>
										<p class="code">mardi</td></tr>
	<tr><td align="center">
										<p class="code">D</td><td><span class="texte">Jour dans l'année</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">189</td></tr>
	<tr><td align="center">
										<p class="code">F</td><td><span class="texte">Jour de la semaine 
										dans le mois</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p><span class="code">2</span> (<i>2</i><sup><i>ème</i></sup><i> mercredi de juillet</i>)</td></tr>
	<tr><td align="center">
										<p class="code">w</td><td><span class="texte">Semaine dans l'année</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">27</td></tr>
	<tr><td align="center">
										<p class="code">W</td><td><span class="texte">Semaine dans le 
										mois</span></td><td align="center"><span class="texte">Nombre</span></td><td>
										<p class="code">2</td></tr>
	<tr><td align="center">
										<p class="code">a</td><td><span class="texte">am/pm marker</span></td><td align="center"><span class="texte">Texte</span></td><td>
										<p class="code">PM</td></tr>
	<tr><td align="center">
										<p class="code">z</td><td><span class="texte">Fuseau horaire</span></td><td align="center"><span class="texte">Texte</span></td><td>
										<p class="code">Pacific Standard Time</td></tr>
	<tr><td align="center">
										<p class="code">'</td><td><span class="texte">Caractère d'échappement</span></td><td align="center"><span class="texte">Séparateur</span></td>
									<td>
										<p class="code">&nbsp;</td>
	</tr>
	<tr><td align="center">
                                    <p class="code">''</td><td><span class="texte">Quote simple</span></td><td align="center"><span class="texte">Littéral</span></td><td>
                                    <p class="code">'</td></tr>
</tbody>
</table>
&nbsp;
                        <p>Le nombre de fois où le symbole est répété détermine 
                        le format final :</p>
                        <ul>
                            <li>Pour les symboles de type &quot;Texte&quot;<br>Si 
                            le symbole est indiqué au plus 3&nbsp;fois, c'est 
                            la forme abrégée qui est affiché si elle existe<br>Exemple 
                            : <br>&nbsp;&nbsp;&nbsp;<span class="code">E</span> 
                            affichera <span class="code">mar. </span>pour mardi<br><br>Si 
                            le symbole est indique plus de 3 fois, c'est la 
                            forme complète qui est affichée.<br>Exemple : <br>&nbsp;&nbsp;&nbsp;<span class="code">EEEE</span> 
                            affichera <span class="code">mardi</span>&nbsp;</li>
                            <li>Pour les symboles de type &quot;Nombre&quot;<br>Indique 
                            le nombre minimum de chiffre. <br>Exemple : <br>&nbsp;&nbsp;&nbsp;<span class="code">d</span> 
                            affichera <span class="code">10</span> si c'est 
                            le dixième jour du mois.<br>&nbsp;&nbsp;&nbsp;<span class="code">dd</span> 
                            affichera <span class="code">01</span> si c'est 
                            le premier jour du mois.<br><br>Cependant, pour 
                            les années, si on indique <span class="code">yy</span>, 
                            seul les deux derniers chiffres de l'année seront 
                            affichés.<br>Exemple : <br>&nbsp;&nbsp;&nbsp;<span class="code">yy</span> 
                            affichera <span class="code">02</span> si l'année 
                            est 2002.<br>&nbsp;&nbsp;&nbsp;yyyy affichera <span class="code">2002</span> 
                            si l'année est 2002.<br>&nbsp;</li>
                            <li>Pour les symboles de type &quot;Texte et Nombre&quot;<br>Si 
                            le symbole est répété 3 fois et plus, c'est la règle 
                            des symboles de type &quot;Texte&quot; qui s'applique<br>Si 
                            le symbole est répété mois de 3 fois, c'est la règle 
                            des symboles de type &quot;Nombre&quot; qui s'applique<br>Exemple 
                            :<br>&nbsp;&nbsp;&nbsp;Pour le mois de février,<br>&nbsp;&nbsp;&nbsp;<span class="code">MM</span> 
                            affichera <span class="code">02</span>;<br>&nbsp;&nbsp;&nbsp;<span class="code">MMM</span> 
                            affichera <span class="code">fév.</span><br>&nbsp;&nbsp;&nbsp;<span class="code">MMMM</span> 
                            affichera <span class="code">février</span></li>
                        </ul>
<h4><span class="code"><a name="FormatDate">@Format</a></span>( 
<span class="param">val</span> 
, <span class="param">format</span> 
, <span class="param">local</span> 
)</h4>
<ul>
    <p>Format expression '<b>val</b>'&nbsp;avec la règle de formatage définie par <span class="param">formatEntrée</span></p>
                            <ul>
                                <li>si val est un nombre, cette fonction est équivalent à <span class="code"><a href="#FormatNumber">@FormatNumber</a></span><a href="#FormatNumber">( 
                                </a><span class="param"><a href="#FormatNumber">val</a></span><a href="#FormatNumber"> 
,  </a><span class="param"><a href="#FormatNumber">format, local)</a></span></li>
                                <li>si val est une date (SQL ou java): cette fonction est équivalent à <span class="code"><a href="#FormatDate">@FormatDate</a></span><a href="#FormatDate">( 
                                </a><span class="param"><a href="#FormatDate">val</a></span><a href="#FormatDate"> 
,  </a><span class="param"><a href="#FormatDate">format</a>)</span>&nbsp;</li>
                            </ul>
</ul>
<h3><a name="Manipulations_URL">f) Manipulations d'URL</a></h3>
<h4><span class="code"><a name="UrlEncode">@UrlEncode</a>( </span><span class="param">expression</span><span class="code"> 
)</span></h4>
<ul>
    <p>En HTML, certains caractères utilisés dans les URLs sont traduit afin 
    qu'ils n'entrent pas en conflit avec la syntaxe même du langage.<br>La fonction 
    <span class="code">@UrlEncode</span>&nbsp;effectue cette conversion sur 
    le contenu de l'expression qu'elle retourne.</p>
</ul>
<p>Voici un exemple en HTML mettant en oeuvre presque toutes les fonctions 
ci-dessus :</p>
<div class="code_exemple">
	&lt;html&gt;<br>
	&lt;head&gt;<br>
	&lt;title&gt;Exemple d'utilisation de fonctions de l'environnement 
	@&lt;/title&gt;<br>
	&lt;/head&gt;<br>
	&lt;body&gt;<br>
	&lt;table border='1'&gt;<br>
	&lt;tr&gt;<br>&lt;td align='center'&gt;<br>&nbsp;&nbsp;&nbsp;&lt;b&gt;Expression&lt;/b&gt;<br>&lt;/td&gt;<br>&lt;td 
	align='center'&gt;<br>&nbsp;&nbsp;&nbsp;&lt;b&gt;Résultat&lt;/b&gt;<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@If(@true,'vrai','faux') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@If(@true,'vrai','faux') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Not(@true) <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Not(@true) 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Mid('abcdefghi','2','3') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Mid('abcdefghi','2','3') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Right('abcdefghi','2') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Right('abcdefghi','2') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Left('abcdefghi','2') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Left('abcdefghi','2') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Length('abcdefghi') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Length('abcdefghi') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Superior('1','2') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Superior('1','2') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Inferior('1','2') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Inferior('1','2') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Max('1','2') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Max('1','2') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
   &lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Min('1','2') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Min('1','2') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
   
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Cmp('A','A') <br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Cmp('A','A') 
	)$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@And(@Cmp('A','A'),@true)<br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@And(@Cmp('A','A'),@true))$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>@Or(@Cmp('a','A'),@Cmp('1','1'))<br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Or(@Cmp('a','A'),@Cmp('1','1')))$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Replace('Je vous dis bonsoir','bonsoir','bonjour')<br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Replace('Je 
	vous dis bonsoir','bonsoir','bonjour'))$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;tr&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;@Concat('Ceci ','est ','un ','message ','concaténé')<br>&lt;/td&gt;<br>&lt;td&gt;<br>&nbsp;&nbsp;&nbsp;$@(@Concat('Ceci 
	','est ','un ','message ','concaténé'))$<br>&lt;/td&gt;<br>&lt;/tr&gt;<br>
	&lt;/body&gt;<br>
	&lt;/html&gt;&nbsp; 
</div>

<p>Qui donne le résultat suivant :</p>
<TABLE class="tableau">
<thead>
	<TR>
		<th>Expression</th>
		<th>Résultat</th>
	</TR>
</thead>
<tbody>
	<TR>
	<TD><span class="code">@If(@true,'vrai','faux')</span> </TD>
	<TD><span class="code">vrai</span></TD></TR>
	<TR>
	<TD><span class="code">@Not(@true)</span> </TD>
	<TD><span class="code">false</span></TD></TR>
	<TR>
	<TD><span class="code">@Mid('abcdefghi','2','5')</span> </TD>
	<TD><span class="code">cde</span></TD></TR>
	<TR>
	<TD><span class="code">@Right('abcdefghi','2')</span> </TD>
	<TD><span class="code">hi</span></TD></TR>
	<TR>
	<TD><span class="code">@Left('abcdefghi','2')</span> </TD>
	<TD><span class="code">ab</span></TD></TR>
	<TR>
	<TD><span class="code">@Length('abcdefghi')</span> </TD>
	<TD><span class="code">9</span></TD></TR>
	<TR>
	<TD><span class="code">@Superior('1','2</span>') </TD>
	<TD><span class="code">false</span></TD></TR>
	<TR>
	<TD><span class="code">@Inferior('1','2')</span> </TD>
	<TD><span class="code">true</span></TD></TR>
	<TR>
	<TD><span class="code">@Min('1','2')</span> </TD>
	<TD><span class="code">1</span></TD></TR>
	<TR>
	<TD><span class="code">@Max('1','2')</span> </TD>
	<TD><span class="code">2</span></TD></TR>
	<TR>
	<TD><span class="code">@Cmp('A','A')</span> </TD>
	<TD><span class="code">true</span></TD></TR>
	<TR>
	<TD><span class="code">@And(@Cmp('A','A'),@true)</span></TD>
	<TD><span class="code">true</span></TD></TR>
	<TR>
	<TD><span class="code">@Or(@Cmp('a','A'),@Cmp('1','1'))</span></TD>
	<TD><span class="code">true</span></TD></TR>
	<TR>
	<TD><span class="code">@Replace('Je vous dis bonsoir','bonsoir','bonjour')</span></TD>
	<TD><span class="code">Je vous dis bonjour</span></TD></TR>
	<TR>
	<TD><span class="code">@Concat('Ceci ','est ','un ','message ','concaténé')</span></TD>
	<TD><span class="code">Ceci est un message concaténé</span></TD></TR>
</tbody>
</TABLE>
<h2><a name="environnement_@Input">6. L'environnement @Input</a></h2>
<p>Cet environnement permet de manipuler les informations de l'URL qui a permit 
d'afficher la page courante.&nbsp;</p>
<p>Prenons comme exemple l'URL :</p>
<p align="center"><span class="code">http://www.mon_site.fr:8080/WindexServer/servlet/WindexServer?Param1=Valeur1&amp;Param2=Valeur2</span></p>
        <table class="tableau">
		<thead>
            <tr>
                <th>Fonction</th>
                <th>Résultat</th>
            </tr>
		</thead>
		<tbody>
            <tr>
                <td>
                    <span class="code"><a name="Query">@Query</a></span>
                </td>
                <td>
                    <span class="code">Retourne la liste des arguments:<br>Param1=Valeur1&amp;Param2=Valeur2</span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="code"><a name="Uri">@Uri</a></span>
                </td>
                <td>
                    <span class="code">Retourne :<br>/WindexServer/servlet/WindexServer</span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="code"><a name="Uri">@Uri</a></span>
                </td>
                <td>
                                    <p>Retourne l'URI sans le slash de fin :<br><span class="code">/WindexServer/servlet/WindexServer</span></p>

                </td>
            </tr>
            <tr>
                <td>
                    <span class="code"><a name="Scheme">@Scheme</a></span>
                </td>
                <td>
                    <span class="code">Retourne :<br>http</span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="code">@ServerName</span>
                </td>
                <td>
                    Retourne :<br>www.mon_site.fr
                </td>
            </tr>
                            <tr>
                <td>
                    <span class="code">@ServerPort</span>
                </td>
                <td>
                                    <p>retourne :<br>8080</p>

                </td>
                            </tr>
                            <tr>
                <td>
                    <span class="code">@WebServerURL</span>
                </td>
                <td>
                                    <p>Retourne :<br>&nbsp;</p>

                </td>
                            </tr>
                            <tr>
                <td>
                    <span class="code">@Input(Param1)</span>
                </td>
                <td>
                                    <p>Retourne la partie serveur de l'URL appelante :<span class="code"><br>http://www.mon_site.fr:8080</span></p>

                </td>
                            </tr>
                            <tr>
                <td>
                    <span class="code">@RemoteAddr</span>
                </td>
                <td>
                                    <p>Retourne l'adresse du client </p>

                </td>
                            </tr>
                            <tr>
                <td>
                    <span class="code">@RemoteHost</span>
                </td>
                <td>
                                    <p>Retourne l'hôte du client </p>

                </td>
                            </tr>
		</tbody>
        </table>
                        <h3>a) Fonctions</h3>
                        <h4><span class="code">@<a name="Header">Header</a>( 
                        </span><span class="param">expression</span><span class="code"> 
                        )<a name="upd_031120_g"></a></span></h4>
                        <ul>
                            <p>Retourne la valeur du contenu dans la requête 
                            d'entête (<i>voir la définition RFC HTTP 1.1</i>). 
                            Parmi les principales valeurs que peut prendre <span class="param">expression</span>, notons :</p>
                        </ul>
        <table class="tableau">
		<thead>
            <tr>
                <th>Fonction</th>
                <th>>Résultat</th>
                <th>Exemple</th>
            </tr>
		</thead>
		<tbody>
            <tr>
                <td>
                    <span class="code">Referer</span>
                </td>
                <td>
                    <span class="texte">Adresse de la page d'où l'on vient</span>
                </td>
                <td>
                                    <p class="code">http://www.mon_site.com</p>

                </td>
            </tr>
            <tr>
                <td>
                    <span class="code">User-Agent</span>
                </td>
                <td>
                    <span class="texte">Nom et version du navigateur Internet</span>
                </td>
                <td>
                                    <p class="code">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)
                </td>
            </tr>
            <tr>
                <td>
                    <span class="code">Host</span>
                </td>
                <td>
                    <span class="texte">Hôte du site courant</span>
                </td>
                <td>
                                    <p class="code">www.mon_site.com</p>

                </td>
            </tr>
		</tbody>
        </table>
                        <h4><span class="code">@GetQueryParameter( 
                        </span><span class="param">expression</span><span class="code"> 
                        )<a name="upd_031120_g"></a></span></h4>
                        <ul>
                            <p>Retourne la valeur du paramètre passé en argument sous le nom <b>expression</b>&nbsp;équivalent de&nbsp;<span class="code">@Input(</span><b><span class="code">expression</span></b><span class="code">)</span>.</p>
                        </ul>
                        <h4><span class="code">@CookieValue( 
                        </span><span class="param">cookiename</span><span class="code"> 
                        )<a name="upd_031120_g"></a></span></h4>
                        <ul>
                            <p>Retourne la valeur du cookie de nom <b>cookiename</b> .</p>
                        </ul>
                        <h2><a name="environnement_@WindexResult">7. L'environnement @WindexResult</a></h2>
<p>Cet environnement permet d'accéder au résultat de la requête. Cet environnement 
sera très souvent utilisé avec la fonction d'itération <span class="code"><a href="#Begin">@Begin</a></span>, 
qui permettra de parcourir l'ensemble des réponses proposées.</p>
<p>Les fonctions et variables marquées du pictogramme <img src="../../images/iteration.gif"  border="0" align="absmiddle"> 
sont à utiliser avec la fonction itérative&nbsp;<span class="code"><a href="macro.htm#Begin">@Begin</a></span>.</p>
<h3><a name="Fonctions">a) Fonctions</a></h3>
<h4><span class="code"><a name="NbRecord">@NbRecord</a></span></h4>
<ul>
    <p>Retourne le nombre total de réponses à la requête</p>
</ul>
<h4><span class="code"><a name="NRecord">@NRecord</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Numéro d'ordre de la réponse dans cette requête (<i>à partir de 0</i>). Ce numéro 
    est indicatif est n'a de sens que pour une requête bien précise. Il peut 
    également changer suite à une nouvelle indexation, car des documents peuvent 
    alors avoir été ajoutés ou supprimés, ce qui peut influence l'ordre d'apparition 
    de la réponse.</p>
</ul>
<h4><span class="code"><a name="NItem">@NItem</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Même définition que pour <span class="code"><a href="#NRecord">@NRecord</a></span>, mais la numérotation commence à partir 
    de 1.</p>
</ul>
<h4><span class="code"><a name="NextRecord">@NextRecord</a></span></h4>
<ul>
<p>Retourne le numéro de la première réponse de la page suivante s'il y a plusieurs 
    pages. La numérotation commence à 0. S'il n'y a pas d'autres pages après 
    la page courante, la valeur est vide.</p>
</ul>
<h4><span class="code"><a name="PreviousRecord">@PreviousRecord</a></span></h4>
<ul>
<p>Retourne le numéro de la première réponse de la page précédente s'il y a plusieurs 
    pages. La numérotation commence à 0. S'il n'y a pas d'autres pages avant&nbsp;la 
    page courante, la valeur est vide.</p>
</ul>
<h4><span class="code"><a name="NbMaxRecord">@NbMaxRecord</a></span></h4>
<ul>
<p>Retourne le nombre maximum de réponse à afficher dans une page. Cette valeur 
    peut être modifiée via l'écran de <a href="../SearchConfig/EditSearchTemplate.htm#1a_Page_des_reponses">configuration 
    de la recherche</a>.</p>
</ul>
<h4><span class="code"><a name="NPage">@NPage</a></span></h4>
<ul>
    <p>Numéro de la page affichée.</p>
</ul>
<h4><span class="code"><a name="NbPage">@NbPage</a></span></h4>
<ul>
    <p>Nombre total de page.</p>
</ul>
                        <h4><a name="RecordSet"><span class="code">@RecordSet</span></a><span class="code">( 
                        </span><span class="param">debut</span><span class="code"> 
                        , </span><span class="param">max</span><span class="code"> 
                        )<a name="upd_031120_f"></a></span></h4>
                        <ul>
                            <p>Cette fonction est utilisée pour initialiser 
                            dans l'environnement <span class="code">@WindexResult</span>, 
                            le n° du premier enregistrement à consulter et le 
                            nombre maximum d'enregistrement. Ce sont exactement 
                            les mêmes informations que celle qui sont communiquées 
                            à la fonction d'itération&nbsp;<span class="code"><a href="#Begin">@Begin</a></span>. 
                            Cependant, le fait d'initialiser l'environnement 
                            avant d'atteindre la première fonction @Begin le 
                            concernant, permet de faire d'interroger cet environnement.<br>Comme 
                            cette fonction ne renvoit rien, nous vous suggérons 
                            de l'insérer n'importe où dans la page modèle, de 
                            préférence au tout début. </p>
                            <p>Exemple :</p>
                            <p>Pour afficher le n° de la page courant et le 
                            nombre maximum de pages de réponses, on écrira :</p>
                            <ul>
                                <p><span class="code">$@WindexResult(NPage)$/$@WindexServer(@NbPage)$</span></p>
                            </ul>
                            <p>Cependant, cette ligne ne fonctionnera pas si 
                            elle est insérée avant le <span class="code"><a href="#Begin">@Begin</a></span> 
                            qui affiche le contenu de l'environnement <span class="code"><a href="#environnement_@WindexResult">@WindexResult</a></span>. 
                            Il faudra alors la faire précéder de la ligne suivante 
                            :</p>
                            <ul>
                                <p><span class="code">$@WindexResult(@RecordSet( 
                                @Input(FirstRecord), 
            @NbMaxRecord))$</span></p>
                            </ul>
                        </ul>
<h3><a name="Variables">b) Variables</a></h3>
<h4><span class="code"><a name="Url">Url</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Retourne l'adresse du document.</p>
</ul>
<h4><span class="code"><a name="Title">Title</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Retourne le titre du document. </p>
</ul>
<h4><span class="code"><a name="Summary">Summary</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Retourne le résumé du document. Son contenu est configurable sur la page 
    <a href="summary.htm">Configuration du résumé</a>.</p>
<P>C'est le texte issu :</P>
    <ul>
<LI>pour les documents HTML, d'une balise META description ou à défaut, 
des premiers mots du document. 
<LI>pour un documents PDF, du texte correspondant au sujet du document. </LI>
    </ul>
</ul>
<h4><span class="code"><a name="Weight">Weight</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Indique, sous forme de pourcentage, la pertinence du document, c'est à dire, 
    la possibilité que le document a de correspondre à vos critères. Plus le pourcentage est élevé, plus 
le document se rapproche de votre requête.<br>La pertinence d'un document dépend en partie 
de la position clé du ou des mots recherchés.</p>
</ul>
<table class="tableau">
    <tr>
        <td valign="middle" style="color: #FFF; background-color:#6D7D8D; text-align: center;">
			<img src="../../images/fl_g.gif" align="absmiddle"  border="0"> 
             Plus&nbsp;fort
		</td>
        <td>Mot dans <br>le titre</td>
        <td>Mot dans <br>le résumé</td>
        <td>Mot dans la page ou <br>dans un champ</td>
        <td>Mot dans une champ <br>de type texte</td>
        <td>Mot dans le corps<br>du document</td>
        <td valign="middle" style="color: #FFF; background-color:#6D7D8D; text-align: center;">Moins fort <img src="../../images/fl_d.gif" align="absmiddle"  border="0"></td>
    </tr>
</table>
<ul>
    <p>La pertinence est influencée par la <a href="metatags.htm#Priorite">priorité 
    qui est affectée aux champs</a>.</p>
</ul>
<h4><span class="code"><a name="Weight10">Weight10</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Indique un pertinence comprise entre 0&nbsp;et 10. Cette variable peut être 
    utilisée pour indiquer le nom d'une&nbsp;image symbolisant la pertinence.</p>
</ul>
<div class="code_exemple">&lt;IMG src=&quot;images/pertinence$@WindexResult(Weight10)$.gif&quot; 
	border=&quot;0&quot;&gt;
</div>

<ul>
<p>Ainsi, suivant la pertinence du document, l'image <span class="code">pertinence0.gif</span>, 
    <span class="code">pertinence0.gif</span>, <span class="code">pertinence0.gif 
    </span>... <span class="code">pertinence10.gif</span> sera affichée.</p>
</ul>
<h4><span class="code"><a name="idMemo">idMemo</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>&nbsp;Identifiant interne du document.</p>
</ul>
<h4><span class="code"><a name="Mime">Mime</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Indique le code <a href="mimetypes.htm#code_mime">mime</a> du document. Voici 
    quelques exemples de codes Mime.</p>
    <table class="tableau">
	<thead>
        <tr>
            <th>Code Mime affiché</th>
            <th>Type du fichier</th>
        </tr>
	</thead><tbody>
        <tr>
            <td>
                <p><span class="code">text/html</span></p>
            </td>
            <td>
                <p>Document HTML, PHP, ASP..., </p>
            </td>
        </tr>
        <tr>
            <td>
                <p><span class="code">application/pdf</span></p>
            </td>
            <td>
                <p>Document Adobe Acrobat</p>
            </td>
        </tr>
        <tr>
            <td>
                <p><span class="code">application/msword</span></p>
            </td>
            <td>
                <p>Document Microsoft Word</p>
            </td>
        </tr>
		</tbody>
    </table>
</ul>
<h4><span class="code"><a name="Length2">Length</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Retourne la taille du document indexé (en octets).<br>Certains serveurs Web ne savent pas renvoyer la taille d'une page HTML contenant du code SSI (Server Side Include). Le SSI est un macro langage très rudimentaire permettant de faire des manipulations sur les pages HTML au niveau du serveur, avant qu'une page ne soit renvoyée au navigateur qui l'interroge. Par exemple, vous pouvez faire inclure un fichier texte dans une page HTML.</p>
</ul>
<h4><span class="code"><a name="Update">Update</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Retourne la date de dernière indexation du document.</p>
</ul>
<h4><span class="code"><a name="LastModified">LastModified</a>&nbsp;<img src="../../images/iteration.gif" align="absmiddle"  border="0"></span></h4>
<ul>
<p>Retourne la date de dernière modification du document.</p>
</ul>

<div  class="attention">Cette information peut ne pas être disponible. Elle 
	dépend du serveur sur lequel sont stockés les documents.
</div>

<h2><a name="environnement_@WindexContext">8. L'environnement @WindexContext</a></h2>
<p>Cet environnement permet d'accéder au résultat de la recherche contextuelle. Cet environnement 
sera très souvent utilisé avec la fonction d'itération <span class="code"><a href="macro.htm#Begin">@Begin</a></span>, 
qui permettra de parcourir l'ensemble des réponses proposées.</p>
<p>Les fonctions et variables marquées du pictogramme <img src="../../images/iteration.gif"  border="0" align="absmiddle"> 
sont à utiliser avec la fonction itérative&nbsp;<span class="code">@Begin</span>.</p>
                        <h3>a) Variables</h3>
                        <h4><a name="NextWord"><span class="code">NextWord</span></a> <img src="../../images/iteration.gif"  border="0" align="absmiddle"></h4>
                        <ul>
                            <p>Retourne le mot qui suit le mot recherché</p>
                        </ul>
                        <h4><span class="code">NbNextWord</span> <img src="../../images/iteration.gif"  border="0" align="absmiddle"></h4>
                        <ul>
                        <p>Retourne le nombre de documents contenant le mot 
                            recherché suivi par <span class="code">NextWord</span>.</p>
                        </ul>
</body>

</html>
